<html><head>
<title>MIDI в деталях. Часть 2 — Сообщения канала. - МО</title>

<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<link rel="preload" href="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/integrator.js" as="script"><script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/ca-pub-0269592369109973.js"></script><script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/adsbygoogle.js"></script><script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/osd.js"></script><script type="text/javascript" async="" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/aci.js"></script><script type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/context.js" async=""></script><script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/show_ads_impl.js" id="google_shimpl"></script><script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/ca-pub-0269592369109973.js"></script><script type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/integrator.js"></script><link rel="preload" href="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/integrator_002.js" as="script"><script type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/integrator_002.js"></script><link rel="preload" href="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/show_ads_impl.js" as="script"><link rel="preload" href="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/context_static.js" as="script"><script id="https://an.yandex.ru/partner-code-bundles/8787/context_static.js" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/context_static.js"></script><script type="text/javascript" charset="utf-8" async="" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/d0ac678e6c3095b874ca.js"></script><style type="text/css"> #p69deabf2 .jba863d44{position:fixed !important;left:-1000px !important;top:-1000px !important;width:1px !important;height:1px !important;display:block !important}</style><style type="text/css"> .ef965c5e3{opacity:1 !important;white-space:normal !important;visibility:visible !important}.ef965c5e3,.ef965c5e3 yatag{display:block !important;font-family:inherit !important}.ef965c5e3,.ef965c5e3,.ef965c5e3 a,.ef965c5e3 b,.ef965c5e3 em,.ef965c5e3 iframe,.ef965c5e3 img,.ef965c5e3 table,.ef965c5e3 tbody,.ef965c5e3 td,.ef965c5e3 tr,.ef965c5e3 yatag{box-sizing:content-box !important;color:inherit !important;font-size:inherit !important;font-weight:inherit !important;-webkit-hyphens:manual !important;-ms-hyphens:manual !important;hyphens:manual !important}.ef965c5e3,.ef965c5e3 a,.ef965c5e3 b,.ef965c5e3 em,.ef965c5e3 iframe,.ef965c5e3 img,.ef965c5e3 table,.ef965c5e3 tbody,.ef965c5e3 td,.ef965c5e3 tr{background:none !important;border:none !important;border-radius:0 !important;border-spacing:0 !important;border-collapse:collapse !important;clear:none !important;float:none !important;font-variant:normal !important;letter-spacing:normal !important;line-height:normal !important;margin:0 !important;max-height:none !important;max-width:none !important;min-height:0 !important;min-width:0 !important;outline:none !important;padding:0 !important;position:static !important;text-align:left !important;text-decoration:none !important;text-indent:0 !important;text-transform:none !important;vertical-align:baseline !important;visibility:inherit !important;word-spacing:normal !important}.ef965c5e3,.ef965c5e3 a,.ef965c5e3 b,.ef965c5e3 em,.ef965c5e3 img,.ef965c5e3 table,.ef965c5e3 tbody,.ef965c5e3 td,.ef965c5e3 tr{height:auto !important}.ef965c5e3 table{display:table !important;empty-cells:hide !important;table-layout:fixed !important}.ef965c5e3 table,.ef965c5e3 td{font-size:100% !important}.ef965c5e3 td{display:table-cell !important;vertical-align:middle !important}.ef965c5e3{width:auto !important;height:auto !important;overflow:visible !important}.ef965c5e3{position:relative !important;z-index:1 !important;-webkit-font-smoothing:antialiased !important;-webkit-text-size-adjust:none !important}.ef965c5e3 .x1db623ac,.ef965c5e3 .x1db623ac:hover,.ef965c5e3 .x1db623ac:hover b,.ef965c5e3 .x1db623ac b{display:inline !important;color:#006600 !important;text-decoration:none !important;border-bottom-color:rgba(0,102,0,0.4) !important;border-bottom-width:1px !important;border-bottom-style:solid !important}.ef965c5e3 .x1db623ac:hover,.ef965c5e3 .x1db623ac:hover b{color:#DD0000 !important;border-bottom-color:rgba(221,0,0,0.4) !important}.ef965c5e3 a:focus{-webkit-user-select:none !important;-moz-user-select:none !important;-ms-user-select:none !important;user-select:none !important}.ef965c5e3 .a154c30d7{cursor:pointer !important}.ef965c5e3 .x3fd5d464{display:inline !important}.ef965c5e3 .y4623338a{overflow-wrap:break-word !important;word-wrap:break-word !important;-webkit-hyphens:auto !important;-ms-hyphens:auto !important;hyphens:auto !important}.ef965c5e3 .d4f43c659,.ef965c5e3 .te2d32b95{overflow:hidden !important}.ef965c5e3 .d4f43c659,.ef965c5e3 .te2d32b95,.ef965c5e3 .fd90c75e0:after{position:absolute !important;top:0 !important;right:0 !important;bottom:0 !important;left:0 !important}.ef965c5e3 .fd90c75e0:after{content:"" !important;display:block !important;background:linear-gradient(rgba(0,0,0,.15),rgba(0,0,0,.5)) !important}.ef965c5e3 .mcf44d63{cursor:pointer !important}.ef965c5e3 .mcf44d63,.ef965c5e3 .xfeb7fbf0{position:relative !important}.ef965c5e3 .xfeb7fbf0:after{content:"" !important;position:absolute !important;top:0 !important;left:-5px !important;bottom:-5px !important;right:0 !important}.ef965c5e3 .xfeb7fbf0.v19633df1:after{left:0 !important;bottom:0 !important}.ef965c5e3 .p6068e37b{z-index:-1 !important;transition:z-index 0s linear .4s !important;cursor:default !important;line-height:1.25 !important}.ef965c5e3 .p6068e37b,.ef965c5e3 .d145c8e2c{position:absolute !important;top:0 !important;left:0 !important;width:100% !important;height:100% !important;overflow:hidden !important}.ef965c5e3 .d145c8e2c{margin-left:100% !important;transition:margin-left .4s ease-out !important}.ef965c5e3 .r8b8fb24d{position:absolute !important;display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;margin-left:0 !important;width:100% !important;height:100% !important;background:#fff !important;background:hsla(0,0%,100%,.98) !important;transition:margin-left .4s ease-out !important}.ef965c5e3 .c9223d4ea{z-index:10 !important;transition:z-index 0s !important}.ef965c5e3 .c9223d4ea .d145c8e2c{margin-left:0 !important}.ef965c5e3 .g8d2ebee5{padding:0 0 4px 4px !important}.ef965c5e3 .u8082070{position:absolute !important;top:50% !important;right:100% !important;margin-top:-9px !important;margin-right:8px !important;padding:0 4px !important;max-width:120px !important;height:18px !important;line-height:18px !important;color:#fff !important;background:#333 !important;background-color:rgba(0,0,0,.8) !important;border-radius:1px !important;visibility:hidden !important;font-size:11px !important;white-space:nowrap !important}.ef965c5e3 .g3ea35b64{position:absolute !important;top:3px !important;right:-6px !important;display:block !important;overflow:hidden !important;width:0 !important;height:0 !important;border-style:solid !important;border-width:6px 0 6px 6px !important;border-color:transparent transparent transparent #333 !important;border-color:transparent transparent transparent rgba(0,0,0,.8) !important}.ef965c5e3 .e48ab0060{position:relative !important;color:#fff !important;letter-spacing:.04em !important}.ef965c5e3 .v9323f0c2{position:relative !important;padding:4px !important;border-radius:0 0 0 20% !important}.ef965c5e3 .s29e09ca2 svg{display:block !important;max-height:none !important}.ef965c5e3 .s29e09ca2 polygon{fill:#000000 !important}.ef965c5e3 .u81a02ec3{margin:-3px !important;width:1em !important;height:1em !important;line-height:1em !important;text-align:center !important;font-size:18px !important}.ef965c5e3 .d27143943{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHZpZXdCb3g9IjAgMCAxNCAxNCI+PHBvbHlnb24gcG9pbnRzPSIxNCwwLjcgMTMuMywwIDcsNi4yOTkgMC43LDAgMCwwLjcgNi4zLDcgMCwxMy4yOTkgMC43LDE0IDcsNy43IDEzLjMsMTQgMTQsMTMuMjk5IDcuNyw3Ij48L3BvbHlnb24+PC9zdmc+") !important}.ef965c5e3 .g8d2ebee5:hover .u8082070{visibility:visible !important}.ef965c5e3 .ub1398c2e:hover .u8082070{display:none !important}.ef965c5e3 .e743316{visibility:visible !important}.ef965c5e3 .e743316 .u8082070{display:none !important}.ef965c5e3 .j48385b78 .u8082070{height:19px !important;line-height:19px !important}.ef965c5e3 .j48385b78 .g3ea35b64{top:2px !important}.ef965c5e3 .b488ea28c .v9323f0c2{padding:5px !important}.ef965c5e3 .b488ea28c .u81a02ec3{margin:-5px !important;font-size:25px !important}.ef965c5e3 .b488ea28c .u8082070{margin-right:9px !important;margin-top:-12px !important;max-width:160px !important;height:22px !important;line-height:22px !important;font-size:13px !important}.ef965c5e3 .b488ea28c .g3ea35b64{right:-7px !important;top:4px !important;border-width:7px 0 7px 7px !important}.ef965c5e3 .g8d2ebee5.ub1398c2e .u8082070{display:none !important}.ef965c5e3 .we1dc69f7 .v9323f0c2{background-color:rgba(0,0,0,.25) !important}.ef965c5e3 .we1dc69f7 .s29e09ca2 polygon{fill:#fff !important}.ef965c5e3 .we1dc69f7 .s29e09ca2.d27143943{background-image:url("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIHN0eWxlPSJmaWxsOiAjZmZmIiB2aWV3Qm94PSIwIDAgMTQgMTQiPjxwb2x5Z29uIHBvaW50cz0iMTQsMC43IDEzLjMsMCA3LDYuMjk5IDAuNywwIDAsMC43IDYuMyw3IDAsMTMuMjk5IDAuNywxNCA3LDcuNyAxMy4zLDE0IDE0LDEzLjI5OSA3LjcsNyI+PC9wb2x5Z29uPjwvc3ZnPg==") !important}.ef965c5e3 .r5ce8f850,.ef965c5e3 .xfeb7fbf0.v19633df1 .g8d2ebee5{padding:0 !important}.ef965c5e3 .xfeb7fbf0.v19633df1.ac91592b1.l26d8ea30{top:3px !important;right:3px !important}.ef965c5e3 .xfeb7fbf0.v19633df1.ac91592b1.l26d8ea30 .v9323f0c2{border-radius:20% !important}.ef965c5e3 .sd9711165{position:absolute !important;top:0 !important;right:0 !important;left:0 !important;bottom:0 !important;width:100% !important;height:100% !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;color:#000 !important;font-size:13px !important;z-index:-1 !important;opacity:0 !important;transition:opacity .3s !important}.ef965c5e3 .sd9711165,.ef965c5e3 .je7901422{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .f9925e678{margin-left:10px !important}.ef965c5e3 .l27c58dae svg{fill:#000 !important}.ef965c5e3 .e7b4fcc76{font-size:15px !important}.ef965c5e3 .c66d12c6b .sd9711165{opacity:1 !important;z-index:10 !important}.ef965c5e3 .md6cc720a{-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;min-width:100% !important;min-height:100% !important;font-size:13px !important}.ef965c5e3 .md6cc720a,.ef965c5e3 .a6df74a2d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;box-sizing:border-box !important}.ef965c5e3 .a6df74a2d{width:100% !important;-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;padding:10px !important}.ef965c5e3 .v54793981{font-weight:700 !important}.ef965c5e3 .na65e02a1{display:none !important;font-weight:700 !important}.ef965c5e3 .t53dcf01f,.ef965c5e3 .na65e02a1{-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .t53dcf01f{overflow:hidden !important}.ef965c5e3 .ta0ffacc5,.ef965c5e3 .t53dcf01f{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;-webkit-flex-shrink:0 !important;-ms-flex-negative:0 !important;flex-shrink:0 !important;box-sizing:border-box !important}.ef965c5e3 .ta0ffacc5{-webkit-align-content:center !important;-ms-flex-line-pack:center !important;align-content:center !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;padding:0 !important;margin:0 !important;position:relative !important}.ef965c5e3 .w7763a8dd{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;box-sizing:border-box !important;margin:5px 0 !important}.ef965c5e3 .o679d137d{display:none !important}.ef965c5e3 .w7763a8dd .mc461ab08{width:100% !important;max-width:250px !important}.ef965c5e3 .o679d137d .mc461ab08{width:100% !important;max-width:180px !important}.ef965c5e3 .mc461ab08{display:block !important;padding:5px !important;background-color:#fff !important;border:1px solid #c8c8c8 !important;border-radius:4px !important;text-align:center !important;color:#555 !important;white-space:nowrap !important;transition-property:border,color !important;transition-duration:.2s !important;cursor:pointer !important;box-sizing:border-box !important}.ef965c5e3 .mc461ab08:hover{color:#333 !important;border-color:#333 !important}.ef965c5e3 .md6cc720a.w4e432b4f .t53dcf01f{padding-bottom:15px !important}.ef965c5e3 .md6cc720a.w4e432b4f .ta0ffacc5,.ef965c5e3 .md6cc720a.w4e432b4f .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important}.ef965c5e3 .md6cc720a.w4e432b4f .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:stretch !important;-ms-flex-align:stretch !important;align-items:stretch !important}.ef965c5e3 .md6cc720a.padb2b30f .t53dcf01f{padding-bottom:5px !important}.ef965c5e3 .md6cc720a.padb2b30f .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important}.ef965c5e3 .md6cc720a.padb2b30f .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;-webkit-align-items:stretch !important;-ms-flex-align:stretch !important;align-items:stretch !important}.ef965c5e3 .md6cc720a.padb2b30f .w7763a8dd{margin:2px 0 !important}.ef965c5e3 .md6cc720a.padb2b30f .mc461ab08{padding:3px !important}.ef965c5e3 .md6cc720a.sae49e2af .t53dcf01f{padding-bottom:15px !important}.ef965c5e3 .md6cc720a.sae49e2af .ta0ffacc5,.ef965c5e3 .md6cc720a.sae49e2af .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important}.ef965c5e3 .md6cc720a.sae49e2af .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:stretch !important;-ms-flex-align:stretch !important;align-items:stretch !important}.ef965c5e3 .md6cc720a.sae49e2af .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.sae49e2af .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.u935bbdd .t53dcf01f{padding-bottom:5px !important}.ef965c5e3 .md6cc720a.u935bbdd .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important}.ef965c5e3 .md6cc720a.u935bbdd .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;-webkit-align-items:stretch !important;-ms-flex-align:stretch !important;align-items:stretch !important}.ef965c5e3 .md6cc720a.u935bbdd .w7763a8dd{margin:2px 0 !important}.ef965c5e3 .md6cc720a.u935bbdd .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.u935bbdd .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.u935bbdd .mc461ab08{padding:3px !important}.ef965c5e3 .md6cc720a.ud8b9e19a .t53dcf01f{padding-bottom:10px !important}.ef965c5e3 .md6cc720a.ud8b9e19a .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .md6cc720a.ud8b9e19a .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-wrap:wrap !important;-ms-flex-wrap:wrap !important;flex-wrap:wrap !important;max-width:540px !important}.ef965c5e3 .md6cc720a.ud8b9e19a .w7763a8dd{width:50% !important;margin:0 !important;padding:5px !important}.ef965c5e3 .md6cc720a.j367ac97a .t53dcf01f{padding-bottom:10px !important}.ef965c5e3 .md6cc720a.j367ac97a .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .md6cc720a.j367ac97a .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-wrap:wrap !important;-ms-flex-wrap:wrap !important;flex-wrap:wrap !important;max-width:340px !important}.ef965c5e3 .md6cc720a.j367ac97a .w7763a8dd{width:50% !important;margin:0 !important;padding:5px !important}.ef965c5e3 .md6cc720a.j367ac97a .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.j367ac97a .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.q50500277 .a6df74a2d{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.q50500277 .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important;padding-left:20px !important}.ef965c5e3 .md6cc720a.q50500277 .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:0 5px !important}.ef965c5e3 .md6cc720a.q50500277 .mc461ab08{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .a6df74a2d{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important;padding-left:15px !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:0 5px !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.vdd3c42e5 .mc461ab08{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.td7d89b17 .a6df74a2d{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.td7d89b17 .v54793981{display:none !important}.ef965c5e3 .md6cc720a.td7d89b17 .na65e02a1{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.td7d89b17 .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important;padding-left:15px !important}.ef965c5e3 .md6cc720a.td7d89b17 .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:0 5px !important}.ef965c5e3 .md6cc720a.td7d89b17 .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.td7d89b17 .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.td7d89b17 .mc461ab08{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.ufe40d7a2{font-size:11px !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .a6df74a2d{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;padding:4px !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .v54793981{display:none !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .na65e02a1{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important;padding-left:10px !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:0 1px !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.ufe40d7a2 .mc461ab08{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.t56547ce1{font-size:11px !important}.ef965c5e3 .md6cc720a.t56547ce1 .a6df74a2d{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;padding:0 !important}.ef965c5e3 .md6cc720a.t56547ce1 .v54793981{display:none !important}.ef965c5e3 .md6cc720a.t56547ce1 .na65e02a1{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.t56547ce1 .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important;padding-left:10px !important}.ef965c5e3 .md6cc720a.t56547ce1 .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:0 2px !important}.ef965c5e3 .md6cc720a.t56547ce1 .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.t56547ce1 .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.t56547ce1 .mc461ab08{padding:0 5px !important;display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important}.ef965c5e3 .md6cc720a.k19d2f1fe{font-size:12px !important}.ef965c5e3 .md6cc720a.k19d2f1fe .a6df74a2d{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important;padding:4px !important}.ef965c5e3 .md6cc720a.k19d2f1fe .v54793981{padding:2px 5px !important}.ef965c5e3 .md6cc720a.k19d2f1fe .na65e02a1{display:none !important}.ef965c5e3 .md6cc720a.k19d2f1fe .t53dcf01f{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .md6cc720a.k19d2f1fe .ta0ffacc5{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-wrap:wrap !important;-ms-flex-wrap:wrap !important;flex-wrap:wrap !important;-webkit-flex-shrink:1 !important;-ms-flex-negative:1 !important;flex-shrink:1 !important}.ef965c5e3 .md6cc720a.k19d2f1fe .w7763a8dd{-webkit-flex-grow:1 !important;-ms-flex-positive:1 !important;flex-grow:1 !important;margin:1px !important}.ef965c5e3 .md6cc720a.k19d2f1fe .o679d137d{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .md6cc720a.k19d2f1fe .ke5639df{display:none !important}.ef965c5e3 .md6cc720a.k19d2f1fe .mc461ab08{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:center !important;-ms-flex-pack:center !important;justify-content:center !important;padding:2px !important}.ef965c5e3 .c66d12c6b .w7763a8dd{opacity:0 !important}.ef965c5e3 .l26d8ea30{position:absolute !important;z-index:11 !important;right:0 !important;top:0 !important}.ef965c5e3 .bbe4d7476{position:absolute !important;left:-101% !important;top:0 !important;width:100% !important;height:100% !important;display:block !important}#ef965c5e3 .r2483f5cd .ya5188fd4,#ef965c5e3 .r2483f5cd .y485b41b5{display:none !important}#ef965c5e3 .r2483f5cd .bbe4d7476{left:0 !important;transition:left .4s ease-out !important}.ef965c5e3 .x8d85563f{font-family: Helvetica,Arial,sans-serif !important;border:inherit !important;border-radius:inherit !important;text-decoration:none !important;color:#000000 !important;font-weight:400 !important;line-height:1.25 !important}.ef965c5e3 .x8d85563f,.ef965c5e3 .b273c2866{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-flow:column nowrap !important;-ms-flex-flow:column nowrap !important;flex-flow:column nowrap !important;position:relative !important;overflow:hidden !important}.ef965c5e3 .b273c2866{background:#FFFFFF !important}.ef965c5e3 .hd60535f{text-decoration:inherit !important;color:inherit !important;font-weight:inherit !important;line-height:inherit !important}.ef965c5e3 .a931a30e0:hover{color:#DD0000 !important}.ef965c5e3 .t317acc90:hover{color:#DD0000 !important}.ef965c5e3 .d82042d86:hover{color:#DD0000 !important;-webkit-text-decoration-color:rgba(221,0,0,0.2) !important;text-decoration-color:rgba(221,0,0,0.2) !important}.ef965c5e3 .i83cce865:hover{border-color:rgba(0,0,204,0.35) !important;color:#FFFFFF !important;fill:#FFFFFF !important}.ef965c5e3 .i83cce865:hover .lf0235e2f{border-color:#FFFFFF !important}.ef965c5e3 .e2fb68a61{display:inline-block !important}.ef965c5e3 .e2fb68a61:hover{color:#DD0000 !important}.ef965c5e3 .hd60535f{line-height:normal !important;letter-spacing:normal !important;-webkit-flex-basis:unset !important;-ms-flex-preferred-size:unset !important;flex-basis:unset !important}.ef965c5e3 .t9a56b01c,.ef965c5e3 .p66ad1374{display:inline-block !important;white-space:nowrap !important;font-size:10px !important;line-height:10px !important;height:10px !important;font-family:Verdana,sans-serif !important;color:inherit !important}.ef965c5e3 .w2289a920{background:#FFFFFF !important;color:#000000 !important;border-radius:0 0 4px 4px !important}.ef965c5e3 .w2289a920,.ef965c5e3 .x112aa72{display:block !important;font-size:10px !important;line-height:18px !important;height:18px !important;padding:0 6px !important;position:absolute !important;top:0 !important;z-index:2 !important}.ef965c5e3 .x112aa72{background:none !important;color:rgba(153,153,153,0.7) !important;border-radius:0 !important}.ef965c5e3 .jc8f2e1f7 .p66ad1374{color:#fff !important;text-shadow:0 1px 1px rgba(0,0,0,.25) !important}.ef965c5e3 .jc8f2e1f7{position:absolute !important;top:0 !important;left:0 !important;background:unset !important;background-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAiIGhlaWdodD0iOTAiPjxkZWZzPjxmaWx0ZXIgeD0iLTQ4LjAlIiB5PSItODAuMCUiIHdpZHRoPSIxOTYuMCUiIGhlaWdodD0iMjYwLjAlIiBpZD0iQSI+PGZlR2F1c3NpYW5CbHVyIHN0ZERldmlhdGlvbj0iMTYiIGluPSJTb3VyY2VHcmFwaGljIi8+PC9maWx0ZXI+PC9kZWZzPjxyZWN0IGZpbGw9IiMwMDAiIGZpbHRlcj0idXJsKCNBKSIgeD0iLTMyIiB5PSItNDAiIHdpZHRoPSIxMDAiIGhlaWdodD0iNjAiIHJ4PSIyMCIgZmlsbC1ydWxlPSJldmVub2RkIiBvcGFjaXR5PSIuMjUwIi8+PC9zdmc+") !important;width:120px !important;height:90px !important;z-index:1 !important}.ef965c5e3 .p460d2ac8{display:block !important;color:rgba(153,153,153,0.7) !important;position:absolute !important;bottom:3px !important;right:3px !important}.ef965c5e3 .a915676c9{height:18px !important;width:0 !important}.ef965c5e3 .u33af1535{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important;-webkit-justify-content:flex-start !important;-ms-flex-pack:start !important;justify-content:flex-start !important;box-sizing:border-box !important;line-height:0 !important;z-index:1 !important}.ef965c5e3 .u33af1535,.ef965c5e3 .u33af1535 .pe9f7d624{width:100% !important}.ef965c5e3 .u33af1535 .w1275c3e3{padding:1px 0 !important}.ef965c5e3 .ff25d8525{display:inline-block !important;font-family:Verdana,sans-serif !important;line-height:1.2em !important;padding:0 .4em !important}.ef965c5e3 .g2120f2f9{cursor:default !important}.ef965c5e3 .g2120f2f9 .ff25d8525{font-size:10px !important;white-space:nowrap !important}.ef965c5e3 .y9bbae70c .ff25d8525{font-size:.8em !important}.ef965c5e3 .q23dffcbf{color:#0000CC !important;font-size:1.3em !important;font-weight:700 !important;padding-bottom:.6em !important;line-height:1.25em !important}.ef965c5e3 .p7582336b{font-size:1em !important}.ef965c5e3 .j485d5ce8{font-size:1.1em !important}.ef965c5e3 .g55567869{font-size:1.2em !important}.ef965c5e3 .me623a4ee{font-size:1.3em !important}.ef965c5e3 .h8489c06f{font-size:1.4em !important}.ef965c5e3 .b5764e9ec{font-size:1.5em !important}.ef965c5e3 .x645e056d{font-size:1.6em !important}.ef965c5e3 .j5940ffe2{font-size:1.7em !important}.ef965c5e3 .af7a71b63{font-size:1.8em !important}.ef965c5e3 .cd5c385fb{font-size:1.9em !important}.ef965c5e3 .v802666da{font-size:2em !important}.ef965c5e3 .i86531a78{border-radius:0px !important;overflow:hidden !important}.ef965c5e3 .n3ed47cf,.ef965c5e3 .s10dea69{padding-bottom:1em !important}.ef965c5e3 .m6cc216da{max-width:300px !important}.ef965c5e3 .j27ae2f8b{-webkit-flex-flow:row wrap !important;-ms-flex-flow:row wrap !important;flex-flow:row wrap !important;-webkit-align-items:center !important;-ms-flex-align:center !important;align-items:center !important}.ef965c5e3 .j27ae2f8b,.ef965c5e3 .gf6433609{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-justify-content:flex-start !important;-ms-flex-pack:start !important;justify-content:flex-start !important}.ef965c5e3 .hbed6fc1a,.ef965c5e3 .gf6433609{-webkit-flex-flow:row nowrap !important;-ms-flex-flow:row nowrap !important;flex-flow:row nowrap !important}.ef965c5e3 .hbed6fc1a{display:block !important;overflow:hidden !important;border:1px solid #0000CC !important;background:#0000CC !important;padding:.4em .8em !important;color:#FFFFFF !important;border-radius:4px !important;text-align:center !important;fill:#FFFFFF !important;font-size:12.892320000000002px !important}.ef965c5e3 .m6cc216da .hbed6fc1a{padding:.4em !important}.ef965c5e3 .hf30ea3ed{overflow:hidden !important;height:1.4em !important;text-overflow:ellipsis !important}.ef965c5e3 .ef32c9c79{white-space:nowrap !important;line-height:1.4em !important;height:1.4em !important}.ef965c5e3 .lf0235e2f,.ef965c5e3 .ef32c9c79{display:inline-block !important}.ef965c5e3 .lf0235e2f{box-sizing:border-box !important;line-height:.45em !important;height:.45em !important;width:.45em !important;border:solid #FFFFFF !important;border-width:1px 1px 0 0 !important;-webkit-transform:translateX(-50%) rotate(45deg) !important;transform:translateX(-50%) rotate(45deg) !important;-webkit-transform-origin:100% 100% !important;transform-origin:100% 100% !important}.ef965c5e3 .gf6433609 .hbed6fc1a{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;font-family:Verdana,sans-serif !important;font-size:12px !important;border-radius:8px !important}.ef965c5e3 .b5192ec9e{font-family:Verdana,sans-serif !important;display:block !important;color:#006600 !important;text-align:center !important;line-height:0 !important}.ef965c5e3 .d65171841{font-size:12px !important}.ef965c5e3 .m6cc216da .b5192ec9e{padding-top:.5em !important}.ef965c5e3 .m6cc216da .d65171841{padding-top:.8em !important}.ef965c5e3 .j27ae2f8b .b5192ec9e{padding-left:.8em !important;padding-right:.6em !important}.ef965c5e3 .j27ae2f8b .d65171841{padding-left:1.5em !important;padding-right:1em !important}.ef965c5e3 .r91ade8ca{padding-bottom:1em !important}.ef965c5e3 .w3352c7d2{display:block !important;color:#0000CC !important;line-height:1.7em !important;text-decoration:underline !important;-webkit-text-decoration-color:rgba(0,0,204,0.2) !important;text-decoration-color:rgba(0,0,204,0.2) !important}.ef965c5e3 .c12935c0{padding-bottom:1em !important;opacity:.5 !important}.ef965c5e3 .bd57e24d8{line-height:1.6em !important}.ef965c5e3 .gf30f2538{position:absolute !important;background:rgba(0,0,0,.1) !important;background-size:cover !important;box-shadow:0 1px 2px rgba(0,0,0,.5) !important;border-radius:.5em !important}.ef965c5e3 .r8b8fb24d{background:hsla(0,0%,100%,.98) !important}.ef965c5e3 .mc461ab08{background:hsla(0,0%,100%,.98) !important;color:#555555 !important}.ef965c5e3 .t5f0de921 .m74e54116{-webkit-flex:1 0 auto !important;-ms-flex:1 0 auto !important;flex:1 0 auto !important;display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-flow:row nowrap !important;-ms-flex-flow:row nowrap !important;flex-flow:row nowrap !important;min-height:inherit !important;position:relative !important}.ef965c5e3 .t5f0de921 .p66ad1374{left:1em !important}.ef965c5e3 .t5f0de921 .x112aa72{left:.5em !important}.ef965c5e3 .t5f0de921 .u33af1535{color:#fff !important;position:absolute !important;bottom:0 !important;left:0 !important;right:0 !important}.ef965c5e3 .t5f0de921 .u33af1535 .w1275c3e3{padding:.5em 0 !important}.ef965c5e3 .t5f0de921 .ff25d8525{padding:0 1em !important}.ef965c5e3 .t5f0de921 .c5268f1e1{background:rgba(0,0,0,.25) !important}.ef965c5e3 .t5f0de921 .e65e58673{background-image:linear-gradient(180deg,transparent 0,rgba(0,0,0,.6)) !important}.ef965c5e3 .t5f0de921 .x9efba79d{-webkit-flex:1 0 !important;-ms-flex:1 0 !important;flex:1 0 !important;display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important;-webkit-flex-flow:column nowrap !important;-ms-flex-flow:column nowrap !important;flex-flow:column nowrap !important;padding:.8em 1em 0 1em !important;overflow:hidden !important}.ef965c5e3 .t5f0de921 .i86531a78{-webkit-flex:1 0 !important;-ms-flex:1 0 !important;flex:1 0 !important;display:block !important;background:rgba(0,0,0,.1) center top !important;background-size:cover !important;background-repeat:no-repeat !important;position:relative !important;overflow:hidden !important}.ef965c5e3 .t5f0de921 .s10dea69{margin-top:auto !important}.ef965c5e3 .t5f0de921 .gf30f2538{top:2em !important;left:1em !important}.ef965c5e3 .t5f0de921.ree36d8e .x9efba79d{padding:0 10px 0 1em !important}.ef965c5e3 .n3ed47cf .hd60535f{background-color:INVALID !important}.ef965c5e3 .t317acc90{color:INVALID !important}.ef965c5e3 .a931a30e0{background:INVALID !important;color:INVALID"" !important}.ef965c5e3 .e2fb68a61{background:INVALID !important;color:INVALID !important}.ef965c5e3 .d82042d86{background:INVALID !important;color:INVALID !important}.ef965c5e3 .r91ade8ca{background:INVALID !important}.ef965c5e3 .b5192ec9e{background:INVALID !important}.ef965c5e3 .hbed6fc1a{background-color:INVALID !important}.ef965c5e3 .d5aa60601.x8d85563f .t317acc90{color:INVALID !important}.ef965c5e3 .d5aa60601.x8d85563f .e2fb68a61{color:INVALID !important}.ef965c5e3 .d5aa60601.x8d85563f .a931a30e0{color:INVALID !important}.ef965c5e3 .d5aa60601.x8d85563f .hbed6fc1a{background-color:INVALID !important}.ef965c5e3 .q714d3cfb.x8d85563f .a931a30e0{color:INVALID !important}.ef965c5e3 .xf1102df6{-webkit-flex-flow:row nowrap !important;-ms-flex-flow:row nowrap !important;flex-flow:row nowrap !important;min-width:1px !important;min-height:1px !important}.ef965c5e3 .xf1102df6,.ef965c5e3 .e5154e7c6{display:-webkit-flex !important;display:-ms-flexbox !important;display:flex !important}.ef965c5e3 .e5154e7c6{overflow:hidden !important;-webkit-justify-content:space-between !important;-ms-flex-pack:justify !important;justify-content:space-between !important;-webkit-align-content:space-between !important;-ms-flex-line-pack:justify !important;align-content:space-between !important;-webkit-flex-wrap:wrap !important;-ms-flex-wrap:wrap !important;flex-wrap:wrap !important;margin:auto !important;border:solid #DDDCDA !important;border-width:1px !important;border-radius:0 !important;box-sizing:border-box !important}.ef965c5e3 .g4c7a5413{-webkit-align-items:flex-start !important;-ms-flex-align:start !important;align-items:flex-start !important;visibility:hidden !important}.ef965c5e3 .jdfd809d3{-webkit-flex-direction:row !important;-ms-flex-direction:row !important;flex-direction:row !important}.ef965c5e3 .ne86159af{-webkit-flex-direction:column !important;-ms-flex-direction:column !important;flex-direction:column !important}.ef965c5e3 .w99d17d7d,.ef965c5e3 .o2858a3b2{border-width:0 !important}.ef965c5e3 .w99d17d7d .x8d85563f{border-width:1px !important}.ef965c5e3 .c6f42e051 .x8d85563f{border-width:0 !important;border-radius:0 !important}.ef965c5e3 .ib3af73b3 .x8d85563f{margin:-1px !important;border-radius:0 !important}</style><script charset="utf-8" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/watch.js"></script><script async="" crossorigin="anonymous" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/host.js"></script></head>

<body vlink="656591" topmargin="0" text="000000" marginwidth="0" marginheight="0" link="333367" leftmargin="0" bgcolor="dedede" alink="656591">
<font face="Arial, sans serif">

<center>

<table width="760" cellspacing="0" cellpadding="0" border="0" bgcolor="555581">
<tbody><tr>

<td width="273" height="90" align="CENTER"> 
<a href="http://www.muzoborudovanie.ru/index.php">
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/logo1.gif" alt="Начало" width="260" height="70" border="0"><br>
</a>
</td>

<td width="15"> 
&nbsp;
</td>

<td width="472" align="CENTER">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-0269592369109973";
/* 468x60 */
google_ad_slot = "0177074942";
google_ad_width = 468;
google_ad_height = 60;
//-->
</script>
<script type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/show_ads.js">
</script><ins id="aswift_0_expand" style="display:inline-table;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:468px;background-color:transparent;" data-ad-slot="0177074942"><ins id="aswift_0_anchor" style="display:block;border:none;height:60px;margin:0;padding:0;position:relative;visibility:visible;width:468px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;border:0px;width:468px;height:60px;" width="468" height="60" frameborder="0"></iframe></ins></ins></td>

</tr>
</tbody></table>

<table width="760" cellspacing="0" cellpadding="0" border="0" bgcolor="dedede">
<tbody><tr>
<td width="631">

<table width="631" cellspacing="0" cellpadding="0" border="0" bgcolor="dedede">

<tbody><tr>
<td colspan="4" width="631">
&nbsp;
</td>
</tr>

<tr>
<td width="129" valign="TOP" bgcolor="555581" align="CENTER"> 

<p>
<font size="3">
<br>
<a href="http://www.muzoborudovanie.ru/news/news.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/news2.gif" alt="Новости" width="129" height="28" border="0"></a><a href="http://www.muzoborudovanie.ru/equip/equip.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/equip2.gif" alt="Оборудование" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/articles/articles.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/articles2.gif" alt="Статьи" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/forum/forum.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/forum2.gif" alt="Форум" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/files/files.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/files2.gif" alt="Файлы" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/org/org.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/org2.gif" alt="Организации" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/links/links.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/links2.gif" alt="Ссылки" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/prices/prices.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/price2.gif" alt="Прайс-листы" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/ads/advertiz.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/ads2.gif" alt="Реклама" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/dict.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/dict2.gif" alt="Словарь" width="129" height="25" border="0"></a><a href="http://www.muzoborudovanie.ru/isearch.php"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/isearch2.gif" alt="Поиск" width="129" height="24" border="0"></a>

<font size="0">
<br>
<table width="121" cellspacing="0" cellpadding="2" border="0">

<tbody><tr>
<td bgcolor="333367" align="CENTER">
<font size="1" face="Arial, sans serif" color="ffffff">
СТАТЬИ
</font></td>

</tr><tr>
<td bgcolor="dedede" align="CENTER">
<font size="1" face="Verdana, Tahoma, Arial, sans serif">

<a href="http://www.muzoborudovanie.ru/articles/midi/midi1.php">Часть 1 — Основы.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi3.php">Часть 3 — Системные сообщения.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi4.php">Часть 4 — MIDI Time Code.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi5.php">Часть 5 — Стандартные MIDI-файлы.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi6.php">Часть 6 — Передача данных.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi71.php">Часть 7.1 — MIDI Show Control.</a><br>
<a href="http://www.muzoborudovanie.ru/articles/midi/midi72.php">Часть 7.2 — MIDI Show Control.</a><br>

</font></td></tr><tr>
<td bgcolor="555581">
<font size="0">
&nbsp;
</font></td>

</tr></tbody></table>

</font></font></p></td>

<td width="50">
&nbsp;
</td>

<td width="427" valign="TOP">

<table width="427" cellspacing="0" cellpadding="1" bgcolor="555581">
<tbody><tr>
<td>
<font size="3" face="Arial, sans serif" color="ffffff">
<b>
&nbsp;
MIDI в деталях. Часть 2 — Сообщения канала.
</b></font></td></tr></tbody></table>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<font size="2" face="Arial, sans serif">
<p>
</p><div align="RIGHT">
<b>
Александр ФЕДОРОВ
</b><br>
<a href="http://www.muzoborudovanie.ru/org/mo/mo.php">Музыкальное Оборудование</a>
<br>
октябрь 2003
</div>

<p>
<font size="2" face="Arial, sans serif">
<b>
Вторая часть цикла статей, подробно рассказывающих о протоколе MIDI.
</b>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

</font></font></p><p><font size="2" face="Arial, sans serif"><font size="2" face="Verdana, Tahoma, Arial, sans serif">
В <a href="http://www.muzoborudovanie.ru/articles/midi/midi1.php">первой части</a>
 цикла рассказывалось о предпосылках к появлению MIDI, развитии 
синтезаторов, о процессе подготовки и внедрения спецификации MIDI, 
расширении протокола за последние двадцать лет. Рассматривались 
компоненты MIDI, коммутация устройств, основы двоичной и 
шестнадцатеричной систем счисления. Начато рассмотрение языка MIDI: 
типов сообщений и принципов их кодирования.
</font></font></p><font size="2" face="Arial, sans serif"><font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Мы выяснили, что структура статус-байта MIDI позволяет закодировать семь
 голосовых и шестнадцать системных сообщений. Возможные варианты 
наглядно демонстрирует рис. 1.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/201.gif" alt="Рис. 1" width="250" height="737">
</p>

<p>
Системные сообщения отложим до лучших времен, а сегодня поговорим о 
сообщениях канала — основном строительном материале языка MIDI.
</p>

<p>
Напомню, что сообщения канала делятся на два типа: голосовые и сообщения
 режима канала. Первые связаны со звукообразованием, вторые к этому 
прямого отношения не имеют, но играют в деле управления MIDI-устройством
 не последнюю роль.
</p>

<p>
Голосовое сообщение заставляет тон-генератор произвести какое-либо 
изменение в звуке (или, собственно, сам звук). Например, если 
исполнитель нажимает клавишу, в тон-генератор посылается сообщение Note 
On, на которое тот реагирует воспроизведением ноты. Если исполнитель 
поворачивает колесо модуляции, тон-генератор изменяет глубину модуляции 
звучащей ноты.
</p>

<p>
Во многих случаях то, каким органом управления создается сообщение, 
принципиального значения не имеет. Тогда спецификация привязывает 
сообщение непосредственно к параметру синтеза. Так, для изменения 
панорамы в MIDI-канале используется сообщение Pan, но спецификация не 
уточняет, как оно генерируется. То же самое справедливо и в отношении 
многих других сообщений, например, задающих длительность участков 
огибающей.
</p>

<p>
Особое внимание следует обратить на принципиальный момент: в MIDI все 
параметры синтеза задаются безразмерными числами. Вы поворачиваете 
колесо модуляции — в тон-генератор приходит сообщение типа "колесо 
модуляции: 652". Вы нажимаете клавишу — сообщение имеет вид "нота номер 
60, динамика взятия 120". Тон-генератор сам решает, как преобразовать 
эти числа в реальный коэффициент модуляции, в высоту тона в герцах, и в 
выходной уровень в децибелах.
</p>

<p>
В некоторых случаях спецификация <i>однозначно задает</i> такое 
преобразование. Например, нота с номером 60 должна быть всегда нотой До 
первой октавы и иметь частоту 261 Гц. Тон-генератор подчиняется. В 
других случаях спецификация <i>рекомендует</i>, чтобы, например, при 
динамике 120 уровень на выходе осциллятора снижался на 0,98 дБ от 
максимального. Наконец, для параметров вроде модуляции никаких 
рекомендаций не дается — коэффициент модуляции зависит от особенностей 
внутренней архитектуры инструмента.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Байты данных
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Информацию с органов управления можно разделить на два основных вида: 
логический и числовой. Если, например, педаль имеет только два состояния
 (нажата или отпущена, On/Off), то это — логическая информация. Если же 
мы крутим колесо, то каждое его положение представляется одним значением
 из некоторого диапазона.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Как это закодировать? Для логической информации достаточно, по идее, 
одного бита. Если бит сброшен (0), то педаль (или кнопка) отпущена, если
 установлен (1), то нажата. Но минимальной единицей информации в MIDI 
является байт, в данном случае байт данных. Поэтому придется 
использовать его целиком, несмотря на то, что реально нужен только один 
бит.
</p>

<p>
Для числовой информации один MIDI-байт позволяет закодировать 128 
различных значений (от 0 от 127). А если изменения в звуке требуют более
 тонкой градации? Тогда используются два байта. Диапазон значений, 
который можно закодировать двумя обычными байтами, составляет 2<sup>16</sup>-1,
 то есть от 0 до 65535. Но в MIDI, как говорилось в предыдущей статье, 
один бит из байта расходуется по служебной необходимости, поэтому два 
MIDI-байта дают в наше распоряжение только 14 бит. Но и это уже неплохо:
 2<sup>14</sup> дает 16384 различных значений. Для изменений параметров синтеза этого более чем достаточно.
</p>

<p>
Мы уже говорили, что два байта составляют машинное слово. На рисунке 2 
показана схема "MIDI-слова". Старшие биты обоих байтов заняты (сброшены в
 0; напомню, что таким образом приемник может всегда отличить байт 
данных от статус-байта, в котором старший бит установлен в 1). Биты с 0 
по 6 составляют младший значащий MIDI-байт (LSB, Least Significant 
Byte), c 8 по 14 — старший значащий байт (MSB, Most Significant Byte).
</p>

<br>
 </font></font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/202.gif" alt="Рис. 2" width="606" height="212" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<table cellspacing="0" cellpadding="5" border="0" bgcolor="333367">
<tbody><tr>
<td>

<p>
<font size="2" face="Arial, sans serif" color="ffffff">
<big><b>
MSB и LSB на практике
</b></big><br>

<font size="2" face="Arial, sans serif" color="ffffff">
Для того, чтобы передать число, большее 127, его нужно преобразовать в 
два MIDI-байта, то есть в пару MSB:LSB. Предположим, что орган 
управления (например, колесо) реагирует на самые аккуратные наши 
движения и может передавать свое положение в диапазоне от 0 до 16383. Мы
 повернули колесо в положение 11960. Какие MSB и LSB будут 
сгенерированы?
</font></font></p><font size="2" face="Arial, sans serif" color="ffffff"><font size="2" face="Arial, sans serif" color="ffffff">

<p>
Число 11960 (шестнадцатеричное 0x2EB8) в двоичной форме записывается как
 10111010111000. Для получения LSB нужно взять младшие семь бит 
(0111000) и дополнить их слева нулевым битом, как признаком байта данных
 (см. рис. 2, "упаковка"). Получится 00111000 (десятичное 56, 
шестнадцатеричное 0x38). Для получения MSB берем старшие семь бит 
(1011101) и также дополняем нулевым старшим битом. Получается 01011101 
(десятичное 93, шестнадцатеричное 0x5D). Таким образом, число 11960 в 
виде пары MSB:LSB записывается как 93:56 (или, в шестнадцатеричном виде,
 0x5D:0x38).
</p>

<p>
На практике, естественно, никто с нулями и единицами не заморачивается. 
Для упаковки числа в пару MSB:LSB нужно просто разделить число на 128. 
MSB будет частным от деления, LSB — остатком. Но обычный калькулятор так
 вот сразу вам частное и остаток не покажет. Поэтому алгоритм такой. 
Делим 11960 на 128, калькулятор дает 93,4375. Дробную часть отбрасываем,
 получаем MSB. Умножаем MSB на 128, получаем 11904. Вычитаем это число 
из исходного (11960 — 11904). Получаем LSB.
</p>

<p>
Распаковка выполняется с точностью до наоборот: умножаем MSB на 128, а затем прибавляем LSB (93 x 128 + 56 = 11960).
</p>

</font></font></td>
</tr>
</tbody></table>

</p><p>
Работая с устройствами, удобнее представлять пару MSB:LSB не как одно 
большое число, а как результат грубой и тонкой настройки. MSB можно 
представлять в виде линейки с крупным делением шкалы (128 отрезков, рис.
 3). Но если поднести к линейке лупу, то мы увидим, что каждый отрезок 
состоит еще из 128 частей. Можно представить MSB сантиметрами, а LSB — 
миллиметрами. Зачастую тонкая настройка не нужна даже для тех 
параметров, которые ее позволяют. Достаточно "сантиметровой линейки". С 
помощью нее можно оперировать шагами по 128. Установили MSB в 93, 
получили значение 11904, установили в 94 — получили 12032. Во многих 
случаях такой точности вполне достаточно.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/203.gif" alt="Рис. 3" width="606" height="307" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Но бывает, параметр нужно задать абсолютно точно. Например, в MIDI 
предусмотрено до 16384 банков звуков. Команда "выбрать примерно 15-й 
банк" здесь не пройдет. Нужен точный номер банка, а, следовательно, пара
 MSB:LSB.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Уровни кодирования
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Голосовых сообщений довольно много: это и нажатие/отпускание клавиши, и 
давление на клавишу после нажатия (послекасание), вращение колес высоты 
тона и модуляции, нажатие педалей, кнопок, передвижение слайдеров; 
наконец, сообщения, напрямую задающие параметры синтеза. В общем, почти 
сотня наберется. А на все про все только семь статус-байтов...
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Проблема была решена так: самым часто употребляемым сообщениям выделили 
собственный статус-байт, а для всех остальных сделали 
статус-байт-посредник. Ситуацию можно сравнить с телефонными номерами. 
Для звонков внутри города (предположительно, наиболее частых) вы 
набираете прямой номер, а для междугородных звонков (предположительно, 
более редких) вы должны набрать префикс (код города), и только потом 
номер. Междугородный номер приходиться набирать дольше, чем 
внутригородской. Так и в MIDI — сообщения с прямым статус-байтом 
проходят быстрее, чем сообщения с байтом-посредником.
</p>

<p>
Итак, можно выделить два множества сообщений или, иначе, два уровня 
кодирования. Доступ к первому — прямой, ко второму — только через 
посредника.
</p>

<p>
Следующая таблица показывает сообщения первого уровня (рис. 4). 
Статус-байты даны в двоичном, десятичном и шестнадцатеричном виде. 
Младшая половина статус-байта (4 бита) содержит номер канала, которому 
адресовано сообщение. Так, например статус-байты в диапазоне от 10010000
 (0x90) до 10011111 (0x9F) означают одно и тоже сообщение Note On, в 
диапазоне от 11000000 (0xC0) до 11001111 (0xCF) — сообщение Program 
Change и т. д. То есть, статус-байт, соответствующий одному типу 
сообщения, может быть представлен в шестнадцати вариантах, в зависимости
 от номера канала. В MIDI, как и во всем компьютерном мире, отсчет 
ведется с нуля. При передаче сообщений первый канал кодируется как 0000,
 второй как 0001, а шестнадцатый — как 1111 (десятичное 15, 
шестнадцатеричное 0xF).
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/204.gif" alt="Рис. 4" width="606" height="168" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Основной "целевой группой" MIDI являются инструменты клавишного типа 
(синтезаторы), поэтому набор наиболее часто употребляемых сообщений 
вполне обоснован. Это, прежде всего, сообщения о нажатии и отпускании 
клавиши (Note On / Note Off), сообщения послекасания (Aftertouch Channel
 / Aftertouch Polyphonic), вращения звуковысотного колеса (Pitch Wheel 
Change) и смены программы (Program Change).
</p>

<p>
Статус-байт-посредник получил название Control Change ("изменение 
управления"). В спецификации все сообщения, вызываемые через этот байт, 
называются сообщениями типа Control Change, и предполагается, что они 
"генерируются манипулятором, отличным от клавиатуры". Но, например, 
колесо питч-бенда — тоже манипулятор, отличный от клавиатуры, однако он к
 группе Control Change не относится. Музыканты настолько часто им 
пользуются, что его просто невыгодно помещать во второй уровень. А вот 
колесо модуляции используется пореже, и там ему самое место. Хотя, 
повторю, это все в среднем: иногда вы можете руку не снимать с колеса 
модуляции, а к колесу высоты тона даже не прикоснуться.
</p>

<p>
Таким образом, "сообщения об изменении управления" — название условное, а
 функция статус-байта Control Change служебная. Он просто действует как 
префикс, открывающий путь к другим сообщениям.
</p>

<p>
Получается такая картина. Если пришел статус байт вида 1100nnnn, то 
инструмент сразу по нему определяет тип сообщения, — в данном случае это
 Program Change. Если пришел статус-байт 1011nnnn, то инструмент видит, 
что это байт-посредник, который о типе сообщения ничего не говорит, а 
просто уведомляет: сейчас пойдет сообщение второго уровня. Какое именно —
 смотри байт данных, следующий за посредником. Синтезатор читает этот 
байт и определяет, что это сообщение колеса модуляции. Положение колеса 
будет передано в третьем, завершающем байте (см. рис. 7). Таким образом,
 с помощью статус-байта-посредника и следующего за ним байта данных 
можно закодировать 128 сообщений.
</p>

<p>
Эти сообщения показаны в таблице на рис. 5. Их принято называть 
сообщениями контроллеров, но правильнее было бы называть сообщениями 
второго уровня. Слово контроллер не очень удачно еще и потому, что под 
контроллером часто подразумевается физический орган управления — колесо,
 движок или педаль. Поэтому догадаться о том, что имеется в виду — 
сообщение типа Control Change или физическое устройство, иногда бывает 
очень сложно, даже по контексту. Но традиция сложилась, поэтому под 
словом "контроллер" я буду иметь в виду сообщение второго уровня. А 
физическое устройство буду называть органом управления.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/205.gif" alt="Рис. 5" width="427" height="1268">
</p>

<p>
Сообщения контроллеров обозначаются в документации как СС#N (сообщение 
Control Change номер N, в десятичном представлении), например, сообщение
 колеса модуляции обозначается как CC#1.
</p>

<p>
Из таблицы видно, что часть сообщений контроллеров не определена (такие 
сообщения могут использоваться экспериментаторами и производителями для 
тестирования или отладки оборудования). Восемь последних сообщений 
(СС#120 — CC#127) являются сообщениями режима канала. Они применяются 
довольно редко, поэтому выделять им место в ограниченном первом уровне, 
то есть давать собственный статус-байт, не было смысла.
</p>

<p>
Можно заметить, что многие сообщения, выполняющие одну и ту же функцию, 
представлены двумя вариантами: MSB и LSB. Зачем такое разделение, почему
 не передавать пару MSB:LSB в одном сообщении? Во-первых, это увеличит 
длину всех сообщений второго уровня: за байтом-посредником придется 
передавать не два, а три байта. Многим контроллерам это не нужно — они 
позволяют производить только грубую настройку. Во-вторых, даже для 
контроллеров высокого разрешения часто можно обойтись грубой настройкой,
 и передавать LSB нет смысла.
</p>

<p>
Несмотря на то, что среди сообщений второго уровня есть более 50 
свободных (которые пока не определены), разработчикам, видимо, 
понравилось прятать сообщения за посредниками, и они сделали третий 
уровень кодирования.
</p>

<p>
Идея такая: выделить специальное сообщение контроллера, в байте данных 
которого будет передаваться номер сообщения третьего уровня. Было решено
 задавать такой номер двумя байтами данных. На деле это означает, что 
для адресации должна использоваться пара MSB:LSB. Плюс ко всему, 
сообщения третьего уровня разбили на два типа: <i>зарегистрированные параметры</i> (RPN, Registered Parameter Numbers) и <i>незарегистрированные параметры</i>
 (NRPN, Non Registered Parameter Numbers). Первые кодируются с помощью 
пары CC#101:CC#100, вторые — СС#99:CC#98. Таким образом, третий уровень 
может содержать 16384 зарегистрированных параметров и 16384 
незарегистрированных, то есть всего 32768 сообщений. Что ж, на первое 
время хватит...
</p>

<p>
Спецификация определяет назначение только для зарегистрированных 
параметров. В настоящий момент определены пять параметров, которые 
перечислены в таблице на рис. 6. Организации MMA и JMSC медленно, но 
верно пополняют этот список.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/206.gif" alt="Рис. 6" width="606" height="188" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Незарегистрированные параметры предназначены для свободного 
использования. Каждый производитель может придумывать свои номера NRPN и
 использовать их так, как считает нужным. Фирмы Roland и Yamaha первыми 
приложили к ним руку, что отражено в стандартах GS и XG соответственно. 
Более подробно об NRPN, используемых в этих стандартах, поговорим в 
отдельной статье.
</p>

<p>
Проблема, которая может возникнуть при использовании NRPN, — 
несовместимость устройств. Так, одно устройство может применять NRPN 
номер 1 для настройки добротности эквалайзера, а другое — для изменения 
точки начала петли внутри семпла. Особенно неприятно это при соединении 
приборов в цепь (посредством разъемов Thru). Тогда потенциально 
несовместимые NRPN могут передаваться по всей цепи, что приведет к 
неверной их интерпретации. Многие устройства в этой связи позволяют 
отключить реакцию на NRPN.
</p>

<p>
Как получить доступ к сообщению третьего уровня? Для начала нужно задать
 его номер, используя пару MSB: LSB. Например, для сообщения RPN номер 1
 эта пара будет иметь вид 0:1. Следовательно, нужно послать в CC#101 
значение 0, а в CC#100 — 1. Таким образом, мы даем знать тон-генератору,
 какой параметр нас интересует. Для передачи значения параметра есть 
специально выделенный контроллер высокого разрешения под названием Data 
Entry (пара MSB:LSB, CC#6:CC#38). Предположим, нам нужно задать 
параметру RPN номер 1 значение 500. Пара MSB:LSB в этом случае будет 
иметь вид 3:116 (128 x 3 + 116 = 500). Посылаем в CC#6 значение 3, а в 
CC#38 — 116. Если какой-либо параметр не требует тонкой настройки, 
достаточно послать только MSB посредством контроллера CC#6.
</p>

<p>
Если нужно увеличить или уменьшить на единицу ранее переданное значение 
параметра, то для этого проще воспользоваться сообщениями Data Increment
 (СС#96) или Data Decrement (CC#97). Передавать заново пару MSB:LSB не 
нужно. Байт данных в сообщениях Data Increment/Decrement не используется
 и должен быть равен нулю. Пример использования контроллеров Data Entry и
 Data Increment/Decrement приведен далее, в разделе "RPN".
</p>

<p>
Доступ к параметрам NRPN происходит аналогично, только номер параметра задается парой CC#101:СС#100.
</p>

<p>
На рис. 7 показана схема передачи сообщений разного уровня, а на рис. 8 — требуемое количество байт.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/207.gif" alt="Рис. 7" width="606" height="179" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/208.gif" alt="Рис. 8" width="427" height="242">
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Классификация сообщений
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщения можно разделить на три основные группы: непрерывные, контроллеры-переключатели<i> </i>и простые команды.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<b>Непрерывные контроллеры</b> (Continuous Controllers) — это такие 
контроллеры, которые обычно посылаются целой серией и представляют собой
 поток плавно изменяющихся значений параметра. Например, при перемещении
 колеса модуляции из положения 100 в положение 200 генерируется 
множество сообщений Modulation Wheel, каждое сообщение будет передавать 
текущее положение колеса (в данном случае 100, 101, 102 и т. д.). 
Поскольку отличие двух соседних значений небольшое, будет складываться 
ощущение действительно непрерывного изменения глубины модуляции.
</p>

<p>
Непрерывные контроллеры можно дополнительно разделить на контроллеры 
высокого и контроллеры низкого разрешения. К первому типу спецификация 
относит сообщения из диапазона CC#0-CC#63 и CC#98-CC#101 (то есть пары 
MSB:LSB), ко второму — из диапазона CC#70-CC#95, а также сообщение 
режима канала Poly Mode Off (CC#126).
</p>

<p>
На самом деле, часть этих "непрерывных" контроллеров используется для 
статичной настройки. Например, сообщение Bank Select (выбор банка), в 
отличие от Modulation Wheel, нет смысла посылать целой серией с 
последовательно увеличивающимися номерами банков. Обычно банк выбирается
 один раз, ну иногда меняется по ходу дела. Подобные сообщения 
правильнее было бы назвать "статичными".
</p>

<p>
В первом уровне кодирования к сообщениям непрерывного типа относятся два
 вида послекасания (низкое разрешение) и Pitch Wheel Change (высокое 
разрешение). Сообщения Note Off, Note On и Program Change можно отнести к
 статичным, а сообщение Control Change само по себе ни в какую группу не
 попадает, так как является посредником.
</p>

<p>
Все зарегистрированные параметры третьего уровня также относятся к статичным.
</p>

<p>
<b>Контроллеры-переключатели</b> (СС#64-CC#69) могут передавать только 
два значения: включено или выключено (On/Off). Протокол связывает их с 
педалями всевозможных типов. Сюда же относится сообщение режима канала 
Local Control On/Off (CC#122).
</p>

<p>
<b>Простые команды</b> вообще не передают никакой информации, кроме 
самой команды. Например, сообщение режима канала All Notes Off (CC#123) 
просит тон-генератор выключить звучащие ноты. И только.
</p>

<p>
К простым командам относятся контроллеры CC#96, CC#97, CC#120, CC#121, CC#123, CC#124, CC#125, CC#127.
</p>

<p>
Рис. 9 подытоживает вышесказанное. Некоторые сообщения (вроде панорамы) 
однозначно отнести к непрерывным или статичным сложно. Например, 
панорама (Pan) может выставляться один раз в начале работы, а может 
меняться непрерывно, для создания эффекта перемещения по стереобазе.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/209.gif" alt="Рис. 9" width="606" height="450" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Генерирование сообщений
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
В названии многих сообщений отражен физический орган управления. Но это 
не значит, что, например, сообщение Pitch Wheel Change можно 
генерировать только с помощью звуковысотного колеса. Блоку синтеза 
внутри тон-генератора абсолютно все равно, какой орган управления 
используется. Важно то, какой смысл несет в себе сообщение и на какой 
параметр синтеза влияет. В данном случае изменяется высота тона.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Если вы управляете тон-генератором из секвенсора, то вопрос о 
генерировании сообщений вообще становится второстепенным. Главное — они 
записаны и передаются на выход секвенсора при нажатии кнопки Play. Для 
записи сообщения Pitch Wheel Change вы могли крутить реальное колесо, 
могли нарисовать график с помощью мыши, а могли вводить в память 
устройства "голые" цифры.
</p>

<p>
Современные синтезаторы позволяют управлять массой параметров, но 
количество органов управления на передней панели, как правило, 
ограничено. Так что, например, один и тот же слайдер может 
использоваться для управления разными функциями. Если в данный момент 
нужно управлять частотой среза фильтра, вы назначаете движок на передачу
 соответствующего сообщения. В другой ситуации вы можете использовать 
тот же движок для управления громкостью или панорамой. Одним словом, 
синтезаторы позволят назначать органы управления на передачу любых 
сообщений. Если вам удобнее менять глубину модуляции с помощью фейдера, —
 пожалуйста, назначьте на фейдер сообщение CC#1 (Modulation Wheel).
</p>

<p>
Естественно, сообщения должны быть <i>совместимы по типу</i>. Так, если 
педаль представляет собой контроллер-переключатель, то есть имеет только
 два состояния "нажата/отпущена", то чаще всего нет смысла назначать ее 
для управления непрерывным сообщением вроде модуляции.
</p>

<p>
Кроме того, существует возможность <i>переназначения контроллеров</i>. 
Например, секвенсор можно настроить так, чтобы при приеме сообщений 
Modulation Wheel они преобразовывались в сообщения Pan. Тогда при 
вращении колеса модуляции будут записаны сообщения об изменении 
панорамы. Подобным образом можно настроить и многие тон-генераторы. 
Например, сообщения послекасания, поступающие на MIDI-вход устройства, 
могут преобразовываться в сообщения модуляции. Переназначение можно 
выполнять и на стороне передатчика, когда генерируется сообщение одного 
типа, но прежде чем попасть на MIDI-выход, оно преобразуется в сообщение
 другого типа. Одним словом, переназначение дает дополнительную гибкость
 в управлении MIDI-системой.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Обработка сообщений
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение может поступить напрямую с органа управления, из секвенсора, 
образоваться как результат переназначения — это не так существенно. 
После того, как оно поступило в звукообразующую часть тон-генератора, 
оно должно использоваться по прямому назначению. Так, например, 
сообщение контроллера CC#10 должно приводить к изменению панорамы, а не 
высоты тона. В случаях, когда действие контроллера четко не определено, 
производителю дается свобода выбора. Например, сообщение Foot Pedal 
может управлять темпом ритм-машинки. Для реализации функций, которых нет
 среди стандартных сообщений, могут использоваться сообщения типа 
General Purpose, NRPN или SysEx.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Естественно, не каждое устройство реагирует на все определенные в 
протоколе сообщения. Обычно в руководстве к устройству содержится так 
называемая карта MIDI-реализации (MIDI Implementation Chart), которая 
наглядно показывает, на какие сообщения устройство реагирует, какие 
может генерировать и т. д. Более подробно о картах реализации поговорим в
 статье, посвященной устройствам.
</p>

<p>
Большинство контроллеров действуют на уже звучащие и последующие ноты, 
то есть эффект от их использования слышен немедленно. Сообщения 
контроллеров для одного MIDI-канала не затрагивают другой, поэтому в 
мультитембральном устройстве каждая программа, звучащая на своем канале,
 может иметь собственные настройки контроллеров.
</p>

<p>
Кроме того, инструмент запоминает однажды выставленное значение 
контроллера и использует его до тех пор, пока оно явно не будет изменено
 или не произойдет принудительный сброс посредством специальных команд. 
Так, если сдвинуть колесо модуляции из нулевого положения, то модуляция 
будет применяться к звукам до тех пор, пока не повернуть колесо обратно.
 Со звуковысотным колесом проще — при отпускании оно обычно возвращается
 в исходное состояние автоматически.
</p>

<p>
Тот факт, что устройство "помнит" ранее выставленный контроллер, 
позволяет избежать многократной передачи пары MSB:LSB. Если происходит 
постоянная тонкая подстройка в узком диапазоне, то можно один раз 
передать MSB, а затем — серию из нескольких LSB. Это и удобнее, и время 
передачи уменьшается.
</p>

<p>
Многие устройства не реагируют на тонкую подстройку для большинства 
контроллеров. Это вполне нормально, если производитель считает, что 
повышенная точность в данном сообщении не нужна. Например, в 
контроллерах громкости и экспрессии обычно хватает 128 уровней.
</p>

<p>
Состояние контроллеров-переключателей передается в одном байте, а, 
следовательно, допускает 128 значений. Возникает вопрос — что считать за
 On, а что за Off? Спецификация требует, чтобы значения от 0 до 63 
рассматривались как Off (выключено), а значения от 64 до 127 — как On 
(включено). Для совместимости со старыми инструментами рекомендуется 
всегда посылать Off как 0, а On как 127.
</p>

<p>
Контроллеры, относящиеся к простым командам, не передают дополнительной 
информации, и третий байт в сообщении должен быть всегда равен нулю. 
Приемное устройство должно игнорировать этот байт, даже если по какой-то
 причине он содержит значение, отличное от нуля.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Сообщения режима канала
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
При разработке протокола MIDI упор делался на монотембральные 
устройства. Такие устройства в каждый момент времени воспроизводят 
только одну партию, а, следовательно, принимают и передают данные только
 по одному MIDI-каналу. Для получения рабочего ансамбля, например, баса,
 рояля и скрипки, нужно иметь три монотембральных синтезатора, первый из
 которых будет производить партию баса, второй — рояля, а третий, 
соответственно, скрипки.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Большинство современных инструментов — мультитембральные. Напомню, что 
мультитембральность измеряется в "частях". Вообще-то с английского языка
 слово "part" можно перевести и как "партия" (музыкальная), но в русском
 языке сочетание "однопартийный синтезатор" будет вызывать ненужные 
ассоциации. Когда про синтезатор говорят, что он имеет 
мультитембральность 16 частей, то это значит, что он может принимать 
данные по 16 MIDI-каналам, и на каждом канале партия может звучать своим
 тембром.
</p>

<p>
Однако начнем разговор о режимах применительно к монотембральным устройствам, как того и требует спецификация.
</p>

<p>
В монотембральном тон-генераторе существует так называемый <i>основной канал</i>
 (Basic Channel). Это тот канал, по которому ведется прием или передача 
сообщений. Так, если основной канал имеет номер 3, то сообщения для 
пятого канала, поступающие на вход устройства, будут проигнорированы. 
Обычно основной канал можно выбирать произвольно, но в некоторых 
устройствах он может быть жестко определен — "зашит". Такое устройство 
довольно сложно интегрировать в MIDI-систему. Например, если на первом 
инструменте зашитый основной канал имеет номер 1, а на втором — 2, то 
устройства просто бесполезно соединять MIDI-кабелем. Первое будет всегда
 передавать по каналу 1, а второе — ожидать сообщений по каналу 2. 
Разговор слепого с глухим...
</p>

<p>
Если все же соединить инструменты необходимо, можно включить между ними 
так называемый MIDI-процессор. Он представляет собой небольшую 
коробочку, которая занимается преобразованием MIDI-сообщений в 
соответствии с заданным алгоритмом. Можно настроить процессор таким 
образом, чтобы все сообщения первого канала преобразовывались в 
сообщения второго.
</p>

<p>
Если основной канал можно задавать произвольно, то обычно это делается с
 передней панели инструмента. Некоторые устройства позволяют выбирать 
основной канал посредством сообщений SysEx.
</p>

<p>
Спецификация определяет восемь сообщений режима канала (CC#120-CС#127). 
Однако непосредственно MIDI-режимами управляют только четыре последних. 
Остальные заведуют функциями сброса и локальным управлением. С него и 
начнем.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Local Control
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Если вы записываете партии в секвенсор, используя для этого 
MIDI-клавиатуру и звуковой модуль, то, очевидно, соединяете устройства 
так, как показано на рис. 10. Для того, чтобы записать исполнение, вы 
соединяете MIDI-выход клавиатуры с MIDI-входом секвенсора. Для того, 
чтобы записанную партию можно было прослушивать, вы соединяете 
MIDI-выход секвенсора с MIDI-входом звукового модуля. А чтобы слышать 
то, что играете, в секвенсоре нужно включить режим Thru. В этом режиме 
все сообщения, поступающие на вход секвенсора, транслируются на его 
выход. В конце концов, они попадают в звуковой модуль, и при нажатии 
клавиши вы слышите звук. Здесь все аналогично мониторингу при записи 
аудиосигнала, когда звукоинженер слушает то, что прошло через 
звукозаписывающий тракт.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/210.gif" alt="Рис. 10" width="427" height="410">
</p>

<p>
Теперь представьте, что вместо звукового модуля и MIDI-клавиатуры вы 
используете синтезатор (рис. 11а). В этом случае возникает проблема. 
Когда вы нажимаете клавишу, синтезатор, естественно, издает звук, но в 
то же время передает сообщение о нажатии клавиши в секвенсор. Секвенсор 
его получает и транслирует на свой выход, после чего сообщение попадает 
обратно на вход синтезатора, в результате чего сыгранная вами нота 
дублируется. То есть, при нажатии одной клавиши синтезатор задействует 
два голоса полифонии: один — как реакцию на сигнал от собственной 
клавиатуры, другой — как реакцию на сообщение Note On, полученное с 
MIDI-входа. Короче, говоря языком концертного звукоинженера, получается 
"завязка".
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/211a.gif" alt="Рис. 11a" width="350" height="388">
</p>

<p>
Если при этом нет слышимой задержки между звуками, проблему можно 
рассматривать как терпимую. Но иногда небольшая задержка есть, и вы 
слышите эффект наподобие фленджера. На записанные данные это не влияет, 
но полифония инструмента уменьшается. А полифония — ресурс всегда 
ограниченный, поэтому дублирования нот желательно избегать.
</p>

<p>
Ситуацию, казалось бы, просто исправить, отключив режим Thru в 
секвенсоре. Однако это не выход, поскольку при записи вы все-таки должны
 слышать то, что приходит из секвенсора, а не реакцию инструмента на 
нажатие клавиш. Решение состоит в том, чтобы отключить звукообразующую 
часть синтезатора от его же клавиатуры (рис. 11b). В этом случае 
клавиатура продолжает посылать сообщения на выход, а звукообразующая 
часть продолжает реагировать на вход. Но при нажатии клавиши вы слышите 
только одну ноту — ту, которая поступила из секвенсора.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/211b.gif" alt="Рис. 11b" width="350" height="388">
</p>

<p>
Подобное действие носит название Local Control Off (отключить локальное 
управление). Обычно это можно сделать, нажав кнопку на передней панели 
инструмента.
</p>

<p>
Включать и выключать локальное управление можно также посредством 
сообщения режима канала Local Control On/Off (СС#122). Предположим, что 
основной канал в нашем тон-генераторе имеет номер 5, и что мы хотим 
выключить локальное управление. Тогда последовательность байт, из 
которой должно состоять сообщение Local Control Off, выглядит так, как 
показано на рис. 12.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/212.gif" alt="Рис. 12" width="427" height="185">
</p>

<p>
На рисунке показаны байты в шестнадцатеричном, десятичном и двоичном 
виде, а также даны комментарии по каждому байту. Подобным образом будут 
оформляться все примеры использования сообщений в статьях цикла.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Команды сброса
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Наличие в MIDI двух разных сообщений для взятия и снятия ноты часто 
приводит к так называемым зависшим нотам, о чем уже упоминалось в 
предыдущей статье. Если в тон-генератор пришло сообщение "взять ноту", а
 сообщение "снять ноту" не пришло, нота будет звучать неопределенно 
долго. Такое может случиться, например, во время живого выступления, 
если кто-то наступил на MIDI-кабель, соединяющий MIDI-клавиатуру и 
тон-генератор, и кабель отсоединился. Иногда ноты зависают из-за глюков в
 секвенсоре или в операционной системе тон-генератора. В любом случае 
нужно, чтобы звук прекратился как можно скорее. Для этого используется 
одно из двух сообщений: All Notes Off или All Sound Off.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Сообщение <b>All Notes Off</b> (CC#123) дает команду тон-генератору 
выключить все звучащие на канале ноты. Тон-генератор должен реагировать 
так, как будто для каждой звучащей ноты пришло сообщение Note Off. Таким
 образом, команда All Notes Off включает у каждой ноты участок затухания
 (Release) огибающей. Эта команда должна влиять только на те ноты, 
сообщение о взятии которых пришло через MIDI-вход устройства и не должна
 влиять на ноты, которые были взяты на локальной клавиатуре.
</p>

<p>
Спецификация не требует, чтобы устройство реагировало на команду All 
Notes Off, поскольку аналогичное действие можно выполнить, послав для 
каждой звучащей ноты сообщение Note Off в индивидуальном порядке, хотя 
это и более хлопотно. На некоторых устройствах есть так называемая 
"кнопка паники" (Panic Button). Она, как правило, посылает сообщение All
 Notes Off по всем MIDI-каналам, но может посылать также сообщения Note 
Off для всех номеров нот, и другие команды сброса.
</p>

<p>
Пример последовательности байт для выключения нот на первом MIDI-канале показан на рис. 13.
</p>

<br>
 </font></font></font></font></font></font></font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/213.gif" alt="Рис. 13" width="521" height="185" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Сообщение <b>All Sound Off</b> (CC#120) добавлено в MIDI-спецификацию в 
1991 году. Оно предназначено для немедленного отключения всех звуков на 
канале: нот, "хвостов" реверберации и прочих эффектов, если они 
используются. Таким образом, нотам не предоставляется возможность 
естественного затухания путем перехода в стадию Release огибающей. Как 
говорится в спецификации, "их огибающая должна быть установлена в ноль 
так быстро, насколько это возможно". Сообщение All Sound Off 
генерируется многими секвенсорами в тот момент, когда пользователь 
нажимает кнопку Stop.
</p>

<p>
Сообщение должно влиять только на ноты, полученные через MIDI-вход 
устройства, и не должно влиять на ноты, извлеченные с локальной 
клавиатуры.
</p>

<p>
Сообщение <b>Reset All Controllers</b> (CC#121) появилось в 1988 году. 
Оно дает команду сбросить все контроллеры на канале в начальное 
состояние (состояние по умолчанию, пресетное), за исключением тех, 
которые управляют текущим режимом канала.
</p>

<p>
Пресетные значения каждого контроллера спецификация жестко не определяет
 (тут производители имеют свободу выбора), но рекомендации дает 
следующие. Контроллеры-переключатели (типа Hold Pedal) переводятся в 
состояние Off (педали отпущены). Модуляция устанавливается в 0. 
Экспрессия — в максимум, громкость (MIDI Volume) — в 100, панорама — в 
центр, звуковысотное колесо — в среднее положение. Параметры RPN также 
сбрасываются, в частности, диапазон изменения высоты тона (Pitch Bend 
Sensitivity) устанавливается в +/-2 полутона. Если тон-генератор 
реагирует на послекасание, то оно сбрасывается в 0 для нот, звучащих в 
момент прихода команды.
</p>

<p>
Спецификация не требует, чтобы инструмент реагировал на команду Reset 
All Controllers. В этом случае устройство управления (обычно секвенсор) 
должно сбросить каждый контроллер по отдельности. При этом пресетные 
значения, естественно, будут выбраны производителем секвенсора. Для тех 
устройств, которые реагируют на сброс контроллеров, в документации 
обычно указано, какие пресетные значения используются.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Режимы MIDI
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Многие музыканты, использующие протокол MIDI, считают его режимы 
кошмаром или, по крайней мере, бесполезным усложнением. Многие 
технические специалисты считают эти режимы нерациональными, а многие 
производители устройств реализуют какой-либо один режим, игнорируя 
остальные. Трудно сказать, почему так сложилось: может быть, из-за не 
очень ясных намерений разработчиков и недостаточно доходчивого изложения
 режимов в самой спецификации, или потому, что большинству музыкантов 
они просто не нужны. Во всяком случае, "негатив" укрепился, особенно 
после того, как возросло число мультитембральных устройств.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Однако при всем при этом некоторые MIDI-режимы могут использоваться для 
интересных творческих решений, поэтому полезно иметь о них хотя бы общее
 представление.
</p>

<p>
Так что же такое MIDI-режим? Если кратко, то это схема распределения 
голосов тон-генератора между MIDI-каналами и нотами. Под голосом имеется
 в виду простейшая единица синтеза, минимальная часть ресурсов 
звукообразующей части, которая требуется для воспроизведения одной ноты.
 Производители называют эту единицу по-разному: тон, голос, элемент, 
модуль и т. п. В аналоговом синтезаторе это может быть отдельный 
электронный блок, в цифровом — тайм-слот DSP.
</p>

<p>
Напомню, что тон-генераторы могут быть монофоническими, то есть 
способными в каждый момент производить только одну ноту, и 
полифоническими, то есть способными производить одновременно две ноты и 
более. Полифония современных инструментов находится в широких пределах, 
от 2 до 128 и даже более голосов. Теоретически, такое количество нот 
устройство может производить одновременно. Однако зачастую в пэтчах со 
сложной структурой для генерирования одной ноты используются два, три и 
даже больше голосов. В таких случаях реальная полифония гораздо меньше.
</p>

<p>
Начнем рассмотрение режимов применительно к монотембральному устройству.
</p>

<p>
Сообщения контроллеров из диапазона CC#124-CC#127 задают определенные 
правила работы устройства при приеме и передаче сообщений. Устройство 
должно реагировать на эти команды только в том случае, если они приходят
 по основному каналу. При получении любой из команд все звучащие ноты, 
поступившие ранее на MIDI-вход устройства, должны быть выключены. 
Фактически, при этом выполняется неявный вызов команды All Notes Off.
</p>

<p>
Слово Omni происходит от латинского "Omnis", означающего "все". Команда <b>Omni Mode On</b>
 (СС#125) заставляет тон-генератор принимать голосовые сообщения по всем
 MIDI-каналам, независимо от того, на какой основной канал он настроен. 
Команда <b>Omni Mode Off</b> (CC#124) возвращает к приему по основному каналу. Команда <b>Poly Mode Off</b>
 (СС#126) означает, что тон-генератор должен воспроизводить поступающие 
ноты монофонически. То есть, в каждый момент времени должна 
воспроизводиться только одна нота — последующая нота снимает предыдущую.
 В этой команде передается дополнительный параметр, который имеет смысл 
только в режиме 4 (см. далее). Команда <b>Poly Mode On</b> (CC#127) 
означает, что тон-генератор должен воспроизводить поступающие ноты 
полифонически — количество одновременно звучащих нот ограничивается 
только доступной полифонией.
</p>

<p>
MIDI-режимы образованы сочетанием этих команд (рис. 14а). Всего есть 
четыре режима, а наиболее распространенные из них имеют собственное имя 
(рис. 14b).
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/214a.gif" alt="Рис. 14a" width="350" height="111">
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/214b.gif" alt="Рис. 14b" width="350" height="175">
</p>

<p>
Текущий режим может быть выбран с помощью органов управления на передней
 панели устройства, либо посредством комбинации команд, приведенных 
ранее. Так, например, устройство переходит в режим 1 после получения 
комбинации команд Omni On / Poly On.
</p>

<p>
MIDI-режимы могут быть как у принимающего, так и у передающего 
устройства. Скоммутированные друг с другом приемник и передатчик, как 
правило, должны находиться в одном и том же режиме, в противном случае 
возможна непредсказуемая реакция на голосовые сообщения.
</p>

<p>
Многие устройства поддерживают не все режимы. При получении команд, 
требующих перейти в режим, который не поддерживается, устройство может 
либо проигнорировать их, либо перейти в режим, наиболее близкий по 
смыслу.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Режим 1 (Omni)
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
В этом режиме устройство реагирует на каждое поступившее голосовое 
сообщение, независимо от того, по какому каналу оно пришло. По сути, это
 отказ от системы MIDI-каналов как таковой — младшая половина 
статус-байта, содержащая номер канала, в режиме Omni просто 
игнорируется. При этом инструмент отвечает на сообщения полифонически 
(рис. 15).
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/215.gif" alt="Рис. 15" width="350" height="251">
</p>

<p>
Если в этом режиме находится передающее устройство, то оно должно 
посылать все голосовые сообщения по основному каналу, при этом 
количество одновременно посылаемых нот (полифония) не ограничивается. 
Для монотембрального устройства такое поведение естественно.
</p>

<p>
А теперь представьте, что текущий выбранный пэтч — рояль, а секвенсор 
посылает тон-генератору, находящемуся в режиме Omni, полноценную 
аранжировку, где каждый инструмент играет на своем канале. Мы услышим, 
как звуками рояля будут воспроизводиться все партии аранжировки.
</p>

<p>
Кому это нужно? Хороший вопрос. Разработчики подразумевали, что в этом 
режиме могут работать устройства, которым разделение по каналам не 
требуется. Например, когда есть несколько устройств, соединенных в цепь,
 и при нажатии клавиши на первом все остальные хором повторяют ту же 
ноту. Не правда ли, попахивает концом 70-х, когда такое наложение звуков
 за счет одновременной игры на двух инструментах было актуально? Кстати,
 первые MIDI-инструменты (Roland Jupiter 6, Sequential Circuits Prophet 
600) не различали MIDI-каналов и реагировали на все, что придет. 
Возможно, просто потому, что разработчики торопились к зимней выставке 
NAMM 1983 года, когда нужно было показать MIDI-технологию в действии. 
Интересно, что следующие версии этих инструментов могли уже 
настраиваться на прием по одному из каналов.
</p>

<p>
Некоторые называют режим Omni режимом продавца (sales manager). 
Представьте ситуацию, когда покупатель в магазине музыкального 
оборудования "щупает" два MIDI-устройства и просит продавца включить и 
соединить их с друг с другом. Разработчики, похоже, волновались за тот 
случай, когда при включении питания передающее и приемное устройство 
будут настроены на разные основные каналы, и передача данных между ними 
станет невозможна. А это потенциальных покупателей может огорчить... 
Кстати, спецификация требует, чтобы при включении питания устройства 
находились именно в режиме Omni. Похоже, неспроста.
</p>

<p>
Однако большинство устройств это требование нарушают, и при включении 
питания переходят в тот режим, в которым они находились до выключения.
</p>

<p>
На рис. 16 показан пример последовательности байт, переводящей 
инструмент в режим Omni. Основной канал до перехода в этот режим был 
третий, поэтому пара сообщений Omni On и Poly On должна передаваться по 
третьему каналу.
</p>

<br>
 </font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/216.gif" alt="Рис. 16" width="520" height="240" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Теперь вопрос — если прибор в режиме Omni начинает прием по всем 
каналам, какой канал будет являться основным? Ответ — тот же самый, что 
был до перехода в режим Omni. Переключить устройство в другой режим 
можно, только послав сообщения режима по основному каналу, либо с 
передней панели.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Режим 2
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Этот режим настолько бесполезен, что даже не имеет собственного имени. 
Устройство переходит в него после получения комбинации сообщений Omni On
 / Poly Off. MIDI-спецификация описывает режим 2 так: "Голосовые 
сообщения принимаются по всем каналам, но в каждый момент времени звучит
 только одна нота". Вы можете представить, зачем это нужно? Я тоже с 
трудом. Единственный вариант, который приходит на ум, — это соединение в
 цепь нескольких монофонических синтезаторов. При этом не нужно 
заморачиваться с настройкой основного канала на каждом — они будут 
реагировать на сообщение по любому каналу. Рис. 17 отражает работу 
приемного устройства.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/217.gif" alt="Рис. 17" width="350" height="251">
</p>

<p>
Если в режиме 2 находится передающее устройство, то оно должно посылать 
все голосовые сообщения по основному каналу, при этом ноты могут 
посылаться по одной в каждый момент времени, то есть монофонически, а 
могут и одновременно (полифонически).
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Режим 3 (Poly)
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Этот режим является самым приемлемым для полифонического 
монотембрального устройства. Прием ведется только по одному каналу — 
тому, который является основным. Поступающие сообщения распределяются 
между доступными голосами, то есть инструмент отвечает на сообщения 
полифонически (рис. 18). Передающее устройство работает здесь так же, 
как и в режиме Omni.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/218.gif" alt="Рис. 18" width="350" height="251">
</p>

<p>
В режиме Poly, и только в нем, система MIDI-каналов используется по 
своему прямому назначению. Устройства можно соединять в цепь, при этом 
каждое будет реагировать только на сообщение для одного канала и 
игнорировать другие. Несколько монотембральных тон-генераторов в этом 
режиме могут исполнять мультитембральную аранжировку, передаваемую 
секвенсором.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Режим 4 (Mono)
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Устройство переходит в этот режим после получения комбинации сообщений 
Omni Off / Poly Off. Поведение устройства здесь зависит от параметра, 
переданного в сообщении Poly Off. Если параметр в сообщении имеет 
значение от 1 до 16, то он задает число каналов, на которые будет 
реагировать инструмент, начиная с основного канала. Если параметр равен 
1, то это, по сути, означает монотембральный монофонический инструмент. 
Так, если основной канал у нас третий, то прием будет вестись только по 
нему; следовательно, доступен только один тембр, с одним голосом. 
Рисунок 19 иллюстрирует это.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/219.gif" alt="Рис. 19" width="350" height="251">
</p>

<p>
Однако самое интересное начинается, когда параметр сообщения Poly Off 
больше 1. Если, например, он равен 6, а основной канал — третий, то 
инструмент будет принимать сообщения на каналах 3, 4, 5, 6, 7 и 8 
мультитембрально и монофонически (рис. 20).
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/220.gif" alt="Рис. 20" width="350" height="251">
</p>

<p>
Теперь, если назначить на каждый из этих каналов один и тот же тембр, то
 мы получим систему, идеально подходящую для имитации гитары и других 
струнных инструментов. Каждая струна гитары будет звучать на своем 
MIDI-канале! Это позволит обойти две проблемы. Во-первых, гитара 
позволяет делать подтяжку на одной струне, не смещая высоты тона на 
других струнах. Если поместить всю партию гитары на один MIDI-канал, то 
мы не сможем делать подтяжку выборочно, на каких-либо нотах, — сообщение
 звуковысотного колеса, как и все сообщения контроллеров, действует 
сразу на все ноты канала. Это касается и других приемов игры, таких как 
глиссандо и легато.
</p>

<p>
Во-вторых, гитара имеет возможность играть две одинаковых ноты в один и 
тот же момент на разных струнах. При назначении каждой струне 
собственного канала можно в любой момент времени получить унисон 
независимо от того, насколько гибко тон-генератор обращается с двойными 
нотами на одном канале.
</p>

<p>
В-третьих, струны гитары ведут себя монофонически, то есть при 
защипывании струны новый звук немедленно гасит старый. Режим 4 позволяет
 об этом не беспокоиться — выключение нот произойдет автоматически, так 
как для каждого канала разрешен одновременно только один голос. Ну и, 
наконец, для каждой струны можно задать свой тембр — получится гитара, 
не имеющая аналогов в реальной жизни.
</p>

<p>
На рис. 21 показана последовательность байт, которую нужно послать в 
тон-генератор, чтобы настроить его для имитации шестиструнной гитары. 
При этом основной канал — третий.
</p>

<br>
 </font></font></font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/221.gif" alt="Рис. 21" width="520" height="256" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Если параметр сообщения Poly Off равен нулю, то здесь все происходит 
аналогично предыдущему, с той лишь разницей, что общее число каналов 
будет равно числу доступных голосов полифонии.
</p>

<p>
Типичным передатчиком, работающим в режиме 4, является MIDI-гитара. Она 
должна передавать голосовые сообщения каждой струны по отдельному 
MIDI-каналу, начиная от основного, в каждый момент времени по одной ноте
 на канал.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
MIDI-режимы и мультитембральность
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Складывается впечатление, что авторы MIDI делили тон-генераторы на два 
типа: "полифонические монотембральные" и "монофонические 
мультитембральные". А самое желанное в современном мире сочетание 
"полифонический мультитембральный" как-то обошли стороной.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Правда, на страницах спецификации кое-где проскальзывают загадочные 
фразы о том, что "один физический инструмент может функционировать как 
несколько виртуальных" или "некоторые инструменты могут работать в 
мультирежиме (Multi Mode)". Но, кроме упоминания, ничего о мультирежиме 
не говорится. При этом совершенно ясно, что имеется в виду.
</p>

<p>
Физический инструмент, состоящий из нескольких виртуальных — это 
мультитембральный тон-генератор. А мультирежим — вынужденное изобретение
 производителей как ответ на отсутствие такового в спецификации. Каждая 
часть (программа, тембр) в современном тон-генераторе является, по сути,
 отдельным монотембральным инструментом, к которому применимо все 
сказанное выше. То есть, часть может быть настроена на прием и передачу 
по одному из MIDI-каналов (иметь основной канал), а также работать в 
одном из MIDI-режимов независимо от других частей.
</p>

<p>
Как правило, большинство производителей по умолчанию используют в частях
 режим 3 — в этом случае каждая часть может быть назначена на свой 
MIDI-канал и играть своим тембром, отвечая на поступающие сообщения 
полифонически (рис. 22). В итоге все устройство как одно целое работает в
 так называемом мультирежиме — режиме полифонического мультитембрального
 инструмента.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/222.gif" alt="Рис. 22" width="606" height="253" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
На этом обсуждение режимов закончим и перейдем к голосовым сообщениям.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Программы и банки
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение о смене программы (Program Change) назначает программу (пэтч) 
определенному MIDI-каналу в тон-генераторе. Это сообщение может 
поступить в любой момент, в процессе исполнения или воспроизведения, и, 
таким образом, позволяет динамически менять одну звучащую программу на 
другую. Вообще говоря, разные типы MIDI-устройств могут реагировать на 
это сообщение по-разному. Ритм-машинка может посредством Program Change 
менять текущий паттерн, процессоры эффектов — переключать алгоритмы или 
пресеты.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
В мультитембральном синтезаторе реакция на сообщение Program Change 
может отличаться, в зависимости от того, в каком режиме находится 
инструмент, и на каком канале сообщение пришло. В режиме перфоманса 
обычно меняется не программа, а целая комбинация (перфоманс).
</p>

<p>
Многие тон-генераторы при получении Program Change <i>не выключают</i> 
ноты, которые в этот момент звучат на канале. Например, если во время 
звучания подклада приходит сообщение о смене программы на трубу, то ноты
 подклада продолжают звучать (тембром подклада), а новые ноты будут 
звучать тембром трубы. Но полагаться на такую возможность не стоит — 
есть тон-генераторы, которые выключают звучащие ноты немедленно.
</p>

<p>
Сообщение Program Change имеет один байт данных, в котором содержится 
номер программы. Следовательно, можно выбрать одну из 128 программ. 
Например, как выглядит назначение программы номер 36 на четвертый 
MIDI-канал, показано на рис. 23.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/223.gif" alt="Рис. 23" width="427" height="157">
</p>

<p>
Один из главных подводных камней, на который можно натолкнуться с этим 
сообщением, — нумерация программ в конкретном устройстве. В компьютерном
 мире все начинается с нуля, поэтому номера программ приходят в 
диапазоне от 0 до 127. И действительно, <i>внутри</i> <i>устройства</i> 
программы нумеруются с нуля. Но многие производители считают, что 
музыканты не в состоянии нормально воспринимать программу номер 0 (как, 
впрочем, и MIDI-канал номер 0), и поэтому нумеруют программы <i>для пользователя,</i>
 начиная с 1. Такие "адаптированные" номера могут указываться на 
передней панели или в руководстве к инструменту. Другие фирмы нуля не 
боятся, и первая программа у них, как и положено, имеет номер 0. Отсюда —
 гарантированная путаница при работе с разными инструментами. Хорошо, 
когда программы называются по имени, а если по номеру? В вышеприведенном
 примере программа номер 36 на "адаптированных" инструментах будет 
показана пользователю как 37.
</p>

<p>
Второй подводный камень — совместимость инструментов. На одном 
синтезаторе программе номер 5 может соответствовать гитара, на другом — 
флейта, на третьем — вообще набор ударных. Так что композиция, 
подготовленная на одном инструменте, на другом может звучать, мягко 
говоря, некорректно, что неприемлемо для обмена и распространения. С 
появлением в 1991 году спецификации General MIDI эта проблема была 
отчасти решена — каждому номеру программы сопоставили свой характерный 
тембр. Подробнее о проблемах совместимости поговорим в одной из 
следующих статей.
</p>

<p>
Некоторые старые инструменты имеют меньше 128 программ. Что произойдет, 
если в инструменте, скажем, только 64 программы, а в сообщении Program 
Change пришел номер 110? Скорее всего, сообщение будет проигнорировано. В
 некоторых случаях такой номер может быть преобразован в один из 
доступных.
</p>

<p>
Большинство же современных тон-генераторов содержат более 128 программ 
(в некоторых устройствах число программ превышает 1000). Понятно, что 
выбрать программу, скажем, 512 с помощью одного сообщения Program Change
 нельзя. Поэтому сложилась практика организовывать программы в банки. 
Один банк может содержать, например, 128 программ, и тогда программа с 
номером 512 будет первой программой в пятом банке (128 x 4 = 512).
</p>

<p>
Как ее выбрать? Очень просто — с передней панели инструмента. Сначала 
кнопкой выбирается нужный банк, а затем уже программа. А если то же 
самое нужно сделать посредством MIDI-сообщения? До 1990 года такого 
сообщения не было. Какие только способы не выдумывали производители! Все
 они больше напоминали ритуальные пляски.
</p>

<p>
Например, использовались карты переадресации. Синтезатор настраивался 
так, чтобы, скажем, при получении сообщения Program Change с номером 12 
выбиралась внутренняя программа номер 344. Эта процедура выполнялась для
 всех тембров, используемых в композиции. Другой способ — скопировать 
нужные программы в пользовательский банк, выбрать его вручную с панели 
инструмента, после чего сообщение Program Change позволит использовать 
программы из этого банка. Некоторые производители применяли для 
переключения банков дополнительное MIDI-сообщение, какое именно — 
зависело от конкретного инструмента. Часто использовались сообщения 
SysEx.
</p>

<p>
Наконец в 1990 году организация MMA решила навести порядок и 
стандартизировать процесс выбора банка. Появилось сообщение высокого 
разрешения под названием Bank Select. Его поместили во второй уровень 
кодирования (первый был уже весь занят), к контроллерам, и разбили на 
два контроллера. Старшие 7 бит задаются контроллером СС#0, младшие — 
контроллером СС#32.
</p>

<p>
С помощью Bank Select можно получить доступ к одному из 16384 банков, а 
конкретную программу в этом банке выбрать как обычно — с помощью 
сообщения Program Change. Таким образом, если в каждом банке будет по 
128 программ, то "сладкая парочка" Bank Select / Program Change позволит
 адресовать одну из 2 097 152 программ (16384 x 128). Но не стоит 
впадать в эйфорию от этого числа. Во-первых, ни один производитель пока 
не выпустил инструмента с таким количеством звуков (да и зачем?) 
Во-вторых, есть замечательные инструменты, выпущенные до августа 1990 
года, которые на сообщение Bank Select не реагируют. И выбор нужной 
программы для них по MIDI возможен только с помощью одного из 
вышеупомянутых "древних" способов.
</p>

<p>
Наконец, и это самое неприятное, спецификация MIDI не определяет точного
 механизма выбора звуков с помощью Bank Select. А именно: не определено 
количество доступных банков, число программ в каждом банке и принцип 
нумерации программ. Так что каждый производитель применяет собственные 
схемы, часто на основе сложившейся традиции.
</p>

<p>
Например, в некоторых инструментах банк содержит от 8 до 10 программ, в 
других — 16, 32, 64 или 128. Банки могут нумероваться буквами (A, B, C) 
или цифрами, арабскими или римскими. Нумерация программ в каждом банке 
может начинаться с 0 или с 1. В одном из старых вариантов номер 
программы состоял из двух цифр. Первая определяла банк, вторая — номер 
программы в банке. При этом в каждом банке было по восемь программ. 
Таким образом, первая программа первого банка имела номер 11, потом 
нумерация шла до 18, затем перепрыгивала на 21 (первая программа второго
 банка) и т. д. Буквенно-цифровая нумерация может выглядеть как B054, 
что означает программу номер 54 из банка B.
</p>

<p>
Некоторые производители предложили собственные стандарты, определяющие 
минимальные характеристики совместимых устройств. Частью этих стандартов
 является и схема организации программ в банках. Наиболее известные — GS
 (Roland) и XG (Yamaha), но о них поговорим подробнее в статье, 
посвященной совместимости.
</p>

<p>
При получении сообщения Bank Select тон-генератор не должен выполнять 
каких-либо действий. Полученный номер банка должен сохраняться на 
будущее. А затем, как только поступит сообщение Program Change, 
устройство выберет программу из банка с сохраненным номером. Некоторые 
устройства все же реагируют на Bank Select дополнительными действиями. 
Так, в семплерах это сообщение может служить командой для загрузки 
набора семплов с диска в оперативную память. В некоторых инструментах 
посредством сообщений Bank Select переключаются наборы ударных, что, 
вообще говоря, — нарушение спецификации.
</p>

<p>
Если нужно переключиться на другую программу внутри текущего банка на 
том же MIDI-канале, то достаточно одного сообщения Program Change, 
посылать Bank Select не надо. Если нужно выбрать программу из другого 
банка, то сначала посылается Bank Select, затем Program Change.
</p>

<p>
Большинство устройств содержат менее 128 банков. Некоторые из них в этой
 связи реагируют в сообщении Bank Select только на контроллер СС#0, 
используя его не как MSB, а напрямую как номер банка. Другие требуют 
адресацию с использованием обоих контроллеров (CC#0 и CC#32). 
Спецификация требует, чтобы независимо от числа доступных банков 
использовалась полная схема адресации.
</p>

<p>
Вернемся к нашему примеру с программой 512. Пусть инструмент хранит в 
каждом банке по 128 программ. Тогда программа 512 будет, как говорилось 
ранее, первой программой в пятом банке. Предположим, что мы работаем на 
восьмом MIDI-канале, где текущий банк — третий. Следовательно, для 
выбора программы 512 на шестнадцатый MIDI-канал нужно посылать оба 
сообщения: Bank Select и Program Change (рис. 24).
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/224.gif" alt="Рис. 24" width="427" height="269">
</p>

<p>
Выбор программ возможен также посредством сообщений SysEx, но этот метод
 не является стандартным и зависит от конкретной модели тон-генератора.
</p>

<p>
Нужно учесть, что обработка устройством команд смены банка и программы 
может занять значительное время (десятки миллисекунд и более). Некоторые
 тон-генераторы в момент переключения программы производят посторонний 
шум.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Извлечение звуков
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
MIDI является выраженным клавишно-ориентированным протоколом, поэтому 
процесс извлечения звуков кодируется двумя простыми сообщениями — взять 
ноту (Note On) и снять ноту (Note Off). Исполнитель при нажатии клавиши 
задает сразу три параметра: <i>момент начала звучания</i>, <i>динамику</i> и <i>высоту тона</i>. Длительность звука определяется по моменту отпускания клавиши.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Такая модель хорошо подходит и для ударных инструментов. Здесь, правда, 
основным выразительным средством является динамика, так как высотой тона
 ударных в процессе исполнения чаще всего управлять нельзя, как и 
длительностью звука.
</p>

<p>
К инструментам с другим принципом звукоизвлечения (струнным, духовым) 
такая модель не подходит. Например, на скрипке музыкант может управлять 
тремя указанными параметрами по отдельности: левой рукой он задает 
высоту звука (путем прижатия струны в нужной позиции), правой — момент 
начала и окончания звучания, а также динамику (ведением смычка по 
струне). Эти параметры музыкант может изменять независимо друг от друга,
 причем в процессе звучания. Например, момент появления звука никак не 
укладывается в схему "нажать клавишу с нужной громкостью". Здесь это 
очень тонкий процесс: звук может постепенно возникать из тишины, набирая
 громкость, и так же уходить в тишину, то есть музыкант способен 
изменять динамику в процессе звукоизвлечения.
</p>

<p>
MIDI все упрощает и требует однозначного решения — в какой момент и с 
какой динамикой должна звучать нота. После получения сообщения Note On 
динамика передается в генератор огибающей синтезатора, и ее изменение в 
процессе звучания происходит не по воле музыканта, а автоматически на 
основе параметров огибающей. Конечно, в MIDI есть способы имитации 
"неклавишной" техники звукоизвлечения, но это требует дополнительных 
усилий и хорошего знания возможностей конкретного тон-генератора.
</p>

<p>
В MIDI используется равномерно-темперированный строй и 128 нот различной
 высоты (с номерами от 0 до 127). Частота нот задается с помощью номера.
 Нота с номером 60 — всегда До первой октавы (частота 261 Гц), рис. 25.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/225.gif" alt="Рис. 25" width="150" height="317">
</p>

<p>
Полный частотный диапазон, покрываемый таким образом, превышает 10 октав
 (от 8 Гц до 12543 Гц), что более чем достаточно. Для перевода номера 
ноты в частоту можно использовать формулу на рис. 26.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/226.gif" alt="Рис. 26" width="427" height="210">
</p>

<p>
С номерами нот работать неудобно, но и музыкальный способ наименования (вроде <i>d3 — </i>Ре третьей октавы или <i>Cis1 — </i>До
 диез контроктавы) не подходит; еще и потому, что в разных странах 
применяются разные обозначения. Спецификация MIDI по этому поводу 
молчит, а большинство производителей используют такую систему: октава 
указывается после буквенного обозначения ноты, но первая октава (с 
музыкальной точки зрения) считается третьей. Например, До первой октавы 
называется C3. Производные ступени всегда обозначаются диезами. Так, Ре 
бемоль второй октавы будет называться С#4 (До диез в темперированном 
строе равно Ре бемоль), Соль контроктавы — G1. Нота Си обозначается по 
англо-американской нотации, то есть как B, а не как H. Соответственно, 
Си бемоль будет называться A#. Замечу, что в некоторых инструментах и 
секвенсорах (в основном, старых) До первой октавы обозначается как C4, 
что может привести к путанице. Некоторые устройства в этой связи 
предлагают выбрать, что считать нотой До первой октавы: C3 или C4.
</p>

<p>
Правильная нотация в MIDI не учитывается. Так, если в нотном тексте есть
 нота Ми диез первой октавы, то на языке MIDI она будет называться F3, 
Ля дубль бемоль третьей октавы — G5. Правда, секвенсоры могут показывать
 MIDI-события в виде привычного нотного текста, с правильной нотацией 
(которая зависит от тональности и от других факторов). Многие секвенсоры
 позволяют пользователю самому выбрать знак альтерации для конкретной 
ноты. Но все это сделано лишь для удобства восприятия. В тон-генератор 
посылается только номер ноты, на основании которого он и воспроизводит 
звук с нужной частотой, а как правильно записывается этот звук, с диезом
 или бемолем, тон-генератору все равно.
</p>

<p>
Приведенная на рис. 27 таблица показывает соотношение музыкальных и MIDI-обозначений звуков, их номеров и частот в герцах.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/227.gif" alt="Рис. 27" width="427" height="1445">
</p>

<p>
Темперированный строй может быть изменен на любой другой, если 
тон-генератор отвечает спецификации MIDI Tuning, о чем подробно 
поговорим в одной из следующих статей.
</p>

<p>
Для наборов ударных частота ноты и строй не имеют смысла: в зависимости 
от номера ноты тон-генератор просто запускает сопоставленный с этим 
номером звук. Как правило, звук ударного инструмента обозначается в 
секвенсоре осмысленным именем, а не просто MIDI-номером ноты. Имя 
берется из так называемой карты ударных (Drum Map).
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Динамика
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Динамику извлечения звука называют по-разному: просто динамика, сила 
нажатия, скорость нажатия, громкость. Наиболее корректно в случае 
клавишного инструмента говорить о <i>скорости</i>, поскольку именно 
скорость нажатия клавиши определяет громкость звучания ноты. Сила 
нажатия не всегда однозначно соответствует громкости — так, можно 
довольно сильно давить на клавишу фортепиано, но при этом инструмент 
будет звучать тихо. Это связано с особенностями механики клавишных.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
В спецификации MIDI также используется термин "скорость нажатия", 
Velocity (от англ. "velocity" — "скорость"). Но для удобства (в ущерб 
корректности) я буду называть "скорость нажатия" одним словом — 
"динамика".
</p>

<p>
Сколько уровней динамики достаточно для точной передачи игры 
исполнителя? Однозначно ответить сложно. Разработчики MIDI решили 
кодировать динамику одним байтом данных, и поэтому в MIDI есть 128 
уровней Velocity. Замечу, что уровней громкости целой партии (или 
громкости канала) может быть гораздо больше (см. далее), сейчас речь 
идет только о количестве уровней динамики отдельно взятой ноты.
</p>

<p>
Использование значения динамики (за исключением нулевого) спецификацией 
жестко не определено и зависит от конкретного тон-генератора. Как 
правило, динамика управляет блоком VCA инструмента — в зависимости от 
динамики изменяется время или уровень атаки, а, следовательно, и общая 
громкость звука. Часто динамика управляет параметрами фильтра, делая 
звук ярче при громкой игре. В семплерах может применяться раскладка по 
динамике, когда на одну и ту же ноту вешаются несколько семплов, 
полученных при записи с разными нюансами исполнения. В зависимости от 
динамики воспроизводится нужный семпл, либо результат микширования двух 
смежных семплов (для маскирования их разного спектрального состава). Это
 позволяет довольно успешно имитировать акустические инструменты, звук 
которых может принципиально отличаться по тембру при разной динамике 
исполнения.
</p>

<p>
Возникает вопрос: как должна зависеть громкость сигнала на выходе 
осциллятора от значения Velocity? Спецификация MIDI рекомендует 
тон-генераторам использовать логарифмическую зависимость в соответствии с
 формулой, изображенной на рис. 28.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/228.gif" alt="Рис. 28" width="427" height="101">
</p>

<p>
Где L<i>dB</i> — максимальный уровень на выходе осциллятора при заданной
 огибающей сигнала; обычно точка максимального уровня совпадает с 
моментом завершения стадии атаки. Зависимость амплитуды сигнала (в 
процентах) от значения динамики можно найти по формуле на рис. 29.
</p>

<br>
 </font></font></font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td colspan="2" bgcolor="dedede" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/229.gif" alt="Рис. 29" width="460" height="93" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
При максимальной динамике (Velocity = 127) этот уровень равен 0 дБ 
(100%), при динамике 1 — -84,15 дБ (0,000062%). Значение динамики 0 
используется для служебных целей (см. далее) и в формуле неприменимо. 
Таким образом, MIDI рекомендует использовать для отдельного звука 
динамический диапазон в 84 дБ. Многие тон-генераторы не следуют этой 
рекомендации буквально, ведь для большинства звуков такой огромный 
диапазон просто не нужен. Но все же зависимость, близкая к 
логарифмической, обычно выдерживается на каком-либо отрезке динамики. 
MIDI также рекомендует шкалу соответствия музыкальных динамических 
оттенков и Velocity, показанную на рис. 30.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/230.gif" alt="Рис. 30" width="497" height="113" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Обращает на себя внимание большой промежуток между forte (f, Velocity = 
88) и fortissimo (ff, Velocity = 118). На следующих графиках (рис. 31) 
показана рекомендуемая логарифмическая зависимость: уровень в децибелах 
от динамики (левый график) и относительный уровень (в процентах) от 
динамики (правый график). Для удобства на графиках отмечены музыкальные 
динамические оттенки.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/231.gif" alt="Рис. 31" width="606" height="261" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Нажатие клавиши
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение <b>Note On</b> дает команду тон-генератору сыграть ноту 
заданной высоты с заданной динамикой. Первый байт данных содержит 
MIDI-номер ноты, второй — динамику взятия. Например, при нажатии До 
первой октавы (MIDI-номер 60) на первом MIDI-канале с динамикой 110 
сообщение будет представлено тремя последовательными байтами (рис. 32).
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/232.gif" alt="Рис. 32" width="427" height="214">
</p>

<p>
Результат обработки сообщения — немедленное воспроизведение ноты. Однако
 в пэтчах с длительной атакой может сложиться ощущение задержки после 
нажатия, что вызвано медленным нарастанием громкости звука. Если в 
ритмически значимый момент (например, на сильную долю такта) нота должна
 звучать с уже достаточной громкостью, нужно предусмотреть взятие ноты с
 опережением.
</p>

<p>
Значение динамики посылается тон-генератору только в момент взятия ноты,
 и в зависимости от него формируется громкость звучания на всех стадиях 
огибающей. Отсюда вывод: пока нота звучит, управлять ее громкостью с 
помощью параметра Velocity нельзя. А такая потребность возникает 
довольно часто. Например, в партии подклада или струнного ансамбля, 
когда один аккорд звучит несколько тактов подряд, а, скажем, во втором 
такте нужно увеличить громкость. На помощь приходят другие способы, 
например, послекасание или контроллер экспрессии (см. далее).
</p>

<p>
<table cellspacing="0" cellpadding="5" border="0" bgcolor="333367">
<tbody><tr>
<td>

<p>
<font size="2" face="Arial, sans serif" color="ffffff">
<big><b>
Нулевая динамика
</b></big><br>

<font size="2" face="Arial, sans serif" color="ffffff">
Ситуация, когда параметр Velocity равен нулю, должна отрабатываться 
тон-генератором так, как будто поступило сообщение о снятии ноты. Такое 
поведение необходимо для эффективной работы в режиме <i>Running Status</i>.
 Этот режим позволяет уменьшить количество передаваемых по кабелю байт и
 повысить пропускную способность MIDI. Более подробно Running Status и 
процесс передачи сообщений рассмотрим в следующей статье.
</font></font></p><font size="2" face="Arial, sans serif" color="ffffff"><font size="2" face="Arial, sans serif" color="ffffff">

<p>
Многие устройства генерируют для снятия ноты нормальное сообщение Note 
Off, но есть и такие, которые всегда генерируют Note On с нулевой 
динамикой.
</p>

</font></font></td>
</tr>
</tbody></table>

</p><p>
Нединамические устройства (например, простейшие MIDI-клавиатуры) должны 
передавать в сообщении Note On постоянное значение динамики, равное 64.
</p>

<p>
Спецификация требует, чтобы каждое сообщение Note On для определенной 
ноты на определенном канале было рано или поздно завершено парным 
сообщением Note Off для той же ноты на том же канале (или сообщением 
Note On с нулевой динамикой). Бывают случаи, когда нота заканчивает 
звучание сама по себе, без поступления сообщения Note Off — например, на
 коротких звуках ударных, или из-за формы огибающей, при которой на 
участке спада (Decay) амплитуда падает до нуля, без дальнейшей стадии 
поддержки (Sustain). В таких случаях все равно необходимо сообщение о 
снятии ноты, хотя, вроде бы, звука уже и нет. Тон-генератор считает, что
 нота звучит до тех пор, пока не поступило сообщение об ее снятии.
</p>

<p>
А что произойдет, если во время звучания какой-либо ноты придет 
сообщение о взятии той же ноты на том же MIDI-канале? Здесь все зависит 
от инструмента: под новую ноту может быть отведен свободный голос 
полифонии, и она будет звучать в унисон с уже звучащей, либо ранее 
взятая нота будет "срезана", а новая зазвучит в одиночестве. Во втором 
случае говорят о взаимоисключающем поведении одинаковых нот на одном 
канале (Note Exclusivity on a MIDI channel basis).
</p>

<p>
Другой вариант взаимоисключающего поведения возникает в том случае, если
 в тон-генераторе заданы так называемые группы исключения (exclusive key
 group). Ноты, входящие в такую группу, не могут звучать одновременно. 
Если приходит сообщение о взятии ноты, тон-генератор проверяет: нет ли 
на том же MIDI-канале уже звучащей ноты, относящейся к той же группе, и 
если есть — выключает ее. Группа исключения может быть создана из любого
 набора нот, одновременное звучание которых нежелательно. Чаще всего 
такие группы применяются в наборах ударных для достижения большего 
реализма звучания. Например, группа хета может включать звуки открытого,
 закрытого и педального хай-хета, то есть звуки, которые в реальной 
жизни извлечь одновременно нельзя. Другие примеры: открытый/заглушенный 
треугольник, бубен (удар/отдача), различные варианты guiro, cuica и 
прочая перкуссия.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Отпускание клавиши
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение <b>Note Off</b> дает команду снять ноту заданной высоты. 
Первый байт данных содержит MIDI-номер ноты, второй — динамику ее 
снятия. Снятие ноты заставляет тон-генератор перейти к стадии затухания 
(Release) огибающей. Таким образом, после снятия пальца с клавиши нота 
звучит еще ровно столько, сколько длится этот участок. Правда, если 
отпустить клавишу при нажатой педали сустейна (контроллер CC#64, Hold 
Pedal, см. далее), то звуковой генератор, хотя и получит сообщение Note 
Off, но участок Release не включит. Нота продолжит звучание на участке 
поддержки (Sustain) до тех пор, пока педаль не будет отпущена. При 
отпускании педали генератор, помня о том, что сообщение Note Off уже 
приходило, включит участок Release автоматически, и нота скоро прекратит
 звучание.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<table cellspacing="0" cellpadding="5" border="0" bgcolor="333367">
<tbody><tr>
<td>

<p>
<font size="2" face="Arial, sans serif" color="ffffff">
<big><b>
Note Off в программах ударных
</b></big><br>

<font size="2" face="Arial, sans serif" color="ffffff">
Большинство звуков ударных в тон-генераторах имеют фиксированный по 
времени участок поддержки (Sustain), и, следовательно, длительностью 
перкуссионного звука исполнитель управлять не может. Как и в реальной 
жизни. Обычно в программах ударных тон-генераторы не воспринимают 
сообщение Note Off как команду завершить звук (включить участок 
Release). Нота звучит столько, сколько задано в параметрах огибающей, а 
от момента прихода сообщения Note Off ее длительность не зависит. И, тем
 не менее, команда Note Off рано или поздно должна поступить, как того и
 требует спецификация. В противном случае нарушится внутренняя логика 
работы тон-генератора и пропадет один из голосов полифонии — появится 
типичная "зависшая" нота.
</font></font></p><font size="2" face="Arial, sans serif" color="ffffff"><font size="2" face="Arial, sans serif" color="ffffff">

<p>
Для некоторых звуков (открытые тарелки, свист и др.) управление 
длительностью весьма желательно, и многие тон-генераторы в этом случае 
реагируют на Note Off как и положено.
</p>

</font></font></td>
</tr>
</tbody></table>

</p><p>
Реакция устройства на динамику снятия (то есть скорость отрыва пальца от
 клавиатуры) спецификацией не определена. Чаще всего она не используется
 ни MIDI-контроллерами, ни синтезаторами. Первые, как правило, посылают 
динамику снятия 64, вторые ее просто игнорируют. Есть, правда, несколько
 MIDI-клавиатур из высшего ценового диапазона, которые чувствительны к 
скорости снятия клавиш. При наличии такой клавиатуры можно, в принципе, 
заставить синтезатор реагировать на динамику снятия, например, так, 
чтобы при ее увеличении уменьшалось время затухания (Release).
</p>

<p>
Теперь уже можно рассмотреть полноценный пример. Итак, мы нажимаем ноту 
До первой октавы на первом MIDI-канале с динамикой 110, а потом 
отпускаем ее. Наша клавиатура, нечувствительная к скорости снятия 
клавиш, выдает на выход MIDI Out последовательность из шести байт (рис. 
33).
</p>

<br>
 </font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/233.gif" alt="Рис. 33" width="480" height="294" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
И ждет следующих прикосновений пальцев...
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Послекасание
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Послекасание (Aftertouch) — это давление, прикладываемое к клавише после
 ее нажатия. Послекасание позволяет имитировать приемы звукоизвлечения, 
несвойственные клавишному инструменту, например, вибрато или тремоло, 
причем довольно естественным и удобным способом — нажав клавишу, можно 
непрерывно изменять давление на нее.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Это давление измеряют сенсоры клавиатуры. Делать сенсор под каждую 
клавишу — дорогое удовольствие, поэтому большинство клавиатур имеют один
 сенсор, который измеряет общее давление. Исходя из этого, спецификация 
определяет два варианта послекасания: монофоническое (или послекасание 
канала, Channel Pressure) — это сообщение генерируют клавиатуры с 
одним-единственным сенсором, и полифоническое (Polyphonic Key Pressure) —
 для клавиатур с сенсором на каждую клавишу. Бывают клавиатуры, которые 
не генерируют послекасания вообще.
</p>

<p>
Понятно, что для изменений в звуке генератор должен понимать сообщения 
послекасания и как-то на них реагировать. Обычно изменяются уровень 
поддержки (Sustain) на огибающей громкости или фильтра, или 
глубина/скорость модуляции, производимой генератором низкой частоты. 
Спецификация не определяет конкретной реакции устройства на сообщения 
послекасания, и многие синтезаторы их игнорируют.
</p>

<p>
Послекасание канала менее информативно и не имеет такой гибкости и 
выразительности, как полифоническое. Так, если вы дожмете одну клавишу 
больше другой на устройстве, передающем послекасание канала, оба 
давления будут усреднены, словно вы дожали обе клавиши с одинаковой 
силой. Если в аккорде вы хотите выделить басовую ноту, ничего не выйдет —
 эффект будет применен ко всем нотам, звучащим на канале.
</p>

<p>
Обычно клавиатура посылает один вид послекасания. Но бывают клавиатуры 
(с сенсором на каждую клавишу), которые могут посылать оба вида 
сообщений сразу: полифоническое послекасание формируется как обычно, а 
послекасание канала вычисляется как среднее от полифонического по каждой
 клавише.
</p>

<p>
Послекасание — типичный непрерывный контроллер низкого разрешения, с 
характерной особенностью: оба типа сообщений довольно сильно загружают 
канал передачи данных. Давить на клавиши с постоянным усилием получается
 редко, а при любом изменении давления передается новая порция байт. 
Послекасание канала загружает канал передачи значительно меньше, чем 
полифоническое, так как производит меньше байт в единицу времени.
</p>

<p>
Первый байт данных сообщения полифонического послекасания содержит 
MIDI-номер ноты, второй — давление на клавишу после нажатия. Пример: 
если после взятия аккорда Ре-Фа-Ля первой октавы дожать клавиши так, 
чтобы давление на каждую стало разным (например, 92, 84, 90), то 
сообщение будет представлено девятью байтами (рис. 34, аккорд взят на 
втором MIDI-канале).
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/234.gif" alt="Рис. 34" width="520" height="326" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Стоит изменить давление, как тут же будет сгенерирована новая порция байт.
</p>

<p>
Сообщение послекасания канала состоит из одного байта данных, следующего
 за статус-байтом. Байт данных содержит давление канала. Сообщение 
Channel Pressure для аккорда из предыдущего примера (с усредненным 
давлением, равным 89), показано на рис. 35.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/235.gif" alt="Рис. 35" width="480" height="176" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Звуковысотное колесо
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Звуковысотное колесо (Pitch Wheel) используется для плавного изменения 
высоты тона звучащей ноты. Процесс изменения высоты называется 
питч-бендом (Pitch Bend), а соответствующее MIDI-сообщение — Pitch Wheel
 Change (его часто и называют Pitch Bend). Сообщение об изменении высоты
 относится сразу ко всему MIDI-каналу, поэтому нельзя, например, сыграть
 на одном канале аккорд, а сдвинуть высоту тона только у его басовой 
ноты. Именно по этой причине полноценная имитация эффекта "подтяжки" 
струнного инструмента возможна только в режиме канала 4, о чем 
говорилось ранее.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Pitch Wheel Change — сообщение высокого разрешения, то есть позволяет 
использовать 16384 значений изменения высоты, и относится к контроллерам
 непрерывного типа. При движении колеса высота ноты скачкообразно 
изменяется во времени, но благодаря маленьким шагам (равным 1/16384 
диапазона изменения) эти скачки обычно незаметны, и создается ощущение 
плавного изменения высоты.
</p>

<p>
Первый байт данных сообщения содержит младшие семь бит 14-битной 
величины изменения, второй — старшие семь бит. За центральное положение 
колеса (сдвиг высоты тона отсутствует) принято значение 8192 (16384 / 2,
 шестнадцатеричное 0x2000). Значения больше 8192 означают повышение 
высоты тона, меньше — понижение. Пара MSB:LSB для центрального положения
 колеса имеет вид 64:0 (8192 / 128 = 64 без остатка), в 
шестнадцатеричном виде — 0x40:0x00.
</p>

<p>
Каков диапазон изменения высоты тона? Спецификация оставляет этот вопрос
 на совести производителя тон-генератора. MIDI-клавиатура (или другое 
средство ввода) всегда передает значения от 0 до 16383 (0x3FFF), 
получаемые с колеса, а тон-генератор интерпретирует их так, как считает 
нужным. Так что нет никакой гарантии, что, соединив два синтезатора по 
MIDI и вращая звуковысотное колесо на одном из них, мы получим на втором
 синтезаторе ту же самую величину изменения высоты нот. Обычно диапазон 
составляет +/-2 полутона от центрального значения, но его можно изменять
 с помощью PRN-параметра Pitch Bend Sensitivity, о чем поговорим далее. 
Большинство тон-генераторов позволяют устанавливать независимый диапазон
 для каждого канала, но есть и такие, в которых диапазон задается 
глобально, на все каналы, или фиксирован на значении +/-2 полутона. 
Попадаются инструменты, которые вообще не реагируют на сообщение Pitch 
Wheel Change.
</p>

<p>
Посмотрим, что посылает MIDI-клавиатура тон-генератору в момент, когда 
звуковысотное колесо находится на одной трети пути от центра к верхней 
точке. Очевидно, что положение колеса соответствует 4/6 (или двум 
третям) от всего диапазона значений: 16384 x 2/3 = 10923. Разобьем это 
значение на составляющие MSB и LSB: MSB = 10923 / 128 = 85, остаток — 
43. Следовательно, пара MSB:LSB будет иметь вид 85:43. (0x55:0x2B). Если
 сообщение передается на пятом MIDI-канале, то оно будет выглядеть так, 
как показано на рис. 36.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/236.gif" alt="Рис. 36" width="480" height="205" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Если нужно повысить или понизить ноту на определенное количество центов,
 то для расчета значений MSB и LSB, посылаемых в сообщении Pitch Wheel 
Change, можно использовать формулы, изображенные на рисунке 37.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/237.gif" alt="Рис. 37" width="427" height="228">
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Модуляция
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение Modulation (CC#1/CC#33) задает глубину частотной модуляции 
(вибрато) и управляет соответствующим LFO-блоком тон-генератора. В 
синтезаторах управление модуляцией происходит обычно с помощью колеса, 
либо рычага на передней панели.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
В духовом MIDI-контроллере эффект вибрато достигается практически так 
же, как и в акустическом инструменте. На клавишном инструменте, которому
 вибрато не свойственно, реалистичный эффект проще получить с помощью 
послекасания, чем с использованием колеса модуляции — это гарантирует, 
что модуляция будет присутствовать только тогда, когда звучит нота. С 
использованием колеса такую гарантию дать нельзя. Если тон-генератор не 
реагирует на сообщения послекасания, а клавиатура может их производить, 
то можно настроить клавиатуру так, чтобы она посылала сообщения 
модуляции вместо сообщений послекасания. Для синтетических звуков 
реализм обычно не нужен, поэтому колесом модуляции можно пользоваться 
свободно, не боясь превысить "естественный" уровень эффекта.
</p>

<p>
Диапазон, в котором изменяется глубина модуляции, спецификация оставляет
 на усмотрение тон-генератора. MIDI-клавиатура (или другое средство 
ввода), как и в случае с питч-бендом, всегда передает значения от 0 до 
16383 (0x3FFF), получаемые с колеса, а тон-генератор интерпретирует их 
так, как считает нужным. Единственное, о чем можно сказать совершенно 
точно — значение 0 отключает модуляцию. Для тонкого управления эффектом 
настройка диапазона глубины очень желательна — можно производить колесом
 более смелые движения без боязни выскочить за реалистичный диапазон. 
Однако способ настройки диапазона в спецификации MIDI не 
стандартизирован. Некоторые тон-генераторы позволяют это сделать 
посредством сообщений SysEx или с помощью NRPN. Спецификации Roland GS и
 General MIDI 2 предлагают дополнительные параметры для управления 
эффектом вибрато, но об этом — в другой статье.
</p>

<p>
Теперь пример. Если мы работаем на третьем MIDI-канале и поворачиваем 
колесо модуляции ровно на половину хода, то будет передано довольно 
много промежуточных положений колеса, а последними поступят байты, 
показанные на рис. 38.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/238.gif" alt="Рис. 38" width="480" height="263" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Духовой контроллер
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение Breath Controller (СС#2/CC#34) призвано имитировать нюансы 
звукоизвлечения на духовых инструментах (например, уровень или время 
атаки, вибрато, громкость во время звучания ноты), поэтому и применяется
 чаще всего на соответствующих пэтчах — деревянных или медных духовых. 
Для акустических звуков духовых это сообщение позволяет добиться большей
 убедительности звучания, для синтетических духовых — добавляет новые 
средства "оживления" пэтча. Можно сказать и так: сообщение Breath 
Controller — это своеобразная версия послекасания с точки зрения 
духовика. Наиболее убедительная имитация духового инструмента получается
 в MIDI-режиме 4.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Как нетрудно догадаться, спецификация здесь умывает руки — реакция 
тон-генератора на сообщение Breath Controller никак не закреплена 
стандартом. Это сообщение может генерироваться любым доступным органом 
управления, способным производить сообщения непрерывного типа, а при 
приеме преобразовываться в Breath Controller (о подобных преобразованиях
 говорилось ранее). Но более убедительные результаты получаются при 
использовании специального средства ввода, которое так и называется — 
духовой контроллер. Некоторые синтезаторы имеют вход под такой 
контроллер. Естественно, духовым контроллером нужно уметь пользоваться.
</p>

<p>
Однако даже если синтезатор поддерживает духовой контроллер, многие 
пэтчи никак на него не реагируют, и чаще всего пользователю предлагается
 настроить реакцию самостоятельно. Обычно настройки касаются генератора 
огибающей. Сообщение имеет высокое разрешение и относится к непрерывным 
контроллерам. На рис. 39 — пример сообщения с духового контроллера на 
первом MIDI-канале (музыкант извлекает звук таким образом, что прибор 
генерирует значение 3000).
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/239.gif" alt="Рис. 39" width="480" height="271" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Портаменто
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Портаменто — эффект, который состоит в скольжении высоты тона от одной 
ноты до следующей: нота начинает звучать на высоте предыдущей, а затем 
постепенно подтягивается к своей нормальной высоте. Акустический аналог 
портаменто — глиссандо тромбона или струнных (особенно характерно оно 
для безладового баса). В синтезаторах эффект портаменто (иногда 
называемый Glide) используется, в основном, для одноголосных мелодий; 
это один из излюбленных приемов при исполнении сольной партии или баса 
на старых аналоговых синтезаторах, делающий звук более интересным.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Режим портаменто включается с помощью сообщения переключателя Portamento
 On/Off (СС#65), обычно назначаемого на педаль. При включенном режиме 
очередная нота начинает звучать на высоте, определяемой последним 
сообщением Note On на данном канале, затем высота плавно скользит к 
нормальной. Основной параметр, влияющий на выразительность эффекта — 
время портаменто, то есть время, за которое происходит скольжение. 
Временем портаменто управляет сообщение Portamento Time (СС#5/СС#37 — 
контроллер высокого разрешения). Стандартное значение для него не 
определено, как, впрочем, и соответствие значения конкретным единицам 
времени (секундам, миллисекундам). Значение 0 означает наименьшее время.
</p>

<p>
Эффект портаменто чем-то напоминает питч-бенд, но главное его отличие от
 последнего в том, что мы управляем не величиной смещения, а временем, 
за которое происходит смещение. В быстрых пассажах это время не должно 
быть слишком большим, иначе отдельных нот будет не разобрать. С другой 
стороны, чем больше время портаменто, тем отчетливее эффект. Во время 
медленных пассажей можно изменять время портаменто между каждой парой 
нот — зачастую только такой способ позволяет добиться нужной 
выразительности.
</p>

<p>
Теперь несколько тонких моментов. Эффект портаменто не требует связной 
игры двух нот (приемом легато), поэтому можно нажать одну клавишу, 
отпустить и пойти покурить. По возвращении можно нажать другую клавишу и
 обнаружить, что синтезатор запомнил высоту последней ноты, а новую взял
 с "подъездом" от старой. Так что пауза между звуками роли не играет. А 
если отпустить клавишу до прекращения скольжения, то есть снять ноту 
раньше, чем она подтянется к своей нормальной высоте? Для тон-генератора
 это не важно — новая нота всегда стартует с нормальной высоты 
предыдущей.
</p>

<p>
При игре с наложением голосов, когда во время удержания одной клавиши 
нажимается другая, затем третья и т. д., все происходит аналогично. 
Исходная высота для каждой следующей ноты принимается равной нормальной 
высоте предыдущей. Если синтезатор находится в полифоническом режиме, то
 все скольжения в этом случае выполняются одновременно и независимо.
</p>

<p>
Возникает вопрос: а что будет, если играть аккордами? Здесь самое время 
вспомнить природу MIDI — никакие два сообщения не могут поступить по 
одному каналу одновременно. Так что аккорд будет состоять из нескольких 
последовательных сообщений Note On, и в данном случае все аналогично 
игре с наложением голосов. Только интервалы между сообщениями Note On 
будут минимальны, да и сказать точно, какая из нот аккорда будет 
передана первой, заранее нельзя — это уж от исполнителя зависит, ведь 
строго одновременно все ноты аккорда он не возьмет. Но тогда скольжение 
каждый раз (и для каждой ноты аккорда) будет случайным — в зависимости 
от очередности прихода сообщений Note On. Такой беспорядок, конечно, 
тоже может считаться выразительным эффектом, но хорошо бы как-то 
сообщить тон-генератору, от какой ноты начинать "подъезд", причем 
сообщить это для каждой из нот аккорда.
</p>

<p>
Подобная необходимость может возникнуть и при игре одноголосной мелодии.
 Например, когда мелодия состоит из узких интервалов, а подъезд к каждой
 ноте хочется получить большой, жирный, как будто на целую октаву. Одним
 словом, желательно, чтобы тон-генератор начинал скольжение не от 
последней взятой ноты, а от установленной исполнителем.
</p>

<p>
Раньше эта задача могла быть выполнена только с записанным материалом, в
 секвенсоре, с помощью так называемых "мнимых нот". Это ноты, в которых 
важна только их высота, а динамика минимальна. Основная задача — сделать
 так, чтобы тон-генератор считал мнимую ноту последней взятой на канале.
 Для этого мнимая нота вставлялась в список событий вручную, 
непосредственно перед реальной нотой, для которой таким образом 
задавалась высота начала скольжения. Так как громкость скольжения 
определяется громкостью той ноты, <i>к которой</i> скользит тон, то динамика мнимой ноты может быть вообще нулевая — тогда ее гарантированно не будет слышно.
</p>

<p>
Мнимые ноты позволяют также обойтись без применения контроллера 
Portamento Time. Если нужно, чтобы высота ноты изменялась быстрее, то 
можно использовать мнимую ноту, более близкую по высоте к следующей. 
Скольжение, правда, начнется с меньшего интервала, но иногда это не так и
 важно.
</p>

<p>
В 1992 году в спецификацию было добавлено сообщение Portamento Control 
(второй уровень кодирования, СС#84), которое призвано заменить мнимые 
ноты. Это сообщение задает номер ноты, от которой выполняется 
скольжение. Оно может быть сгенерировано в реальном времени с помощью 
какого-либо органа управления инструмента, а это значит, что прямо в 
процессе исполнения можно задавать высоту начала скольжения.
</p>

<p>
Реакция тон-генераторов на Portamento Control имеет особенности. Так, 
если номер ноты, поступивший в этом сообщении, равен номеру ноты, 
которая уже звучит, то для подъезда будет использована текущая 
огибающая, без перезапуска генератора огибающей для новой ноты. Если 
инструмент находится в режиме Mono или он принял сообщение о включении 
педали легато, то звучащая нота должна немедленно сменить высоту на ту, 
что задана в сообщении Portamento Control, а затем уже скользить к 
высоте следующей ноты.
</p>

<p>
Настало время примера. Мы работаем на девятом MIDI-канале и выставляем 
время портаменто ровно в середину диапазона, затем выбираем стартовую 
ноту для подъезда, скажем, До первой октавы, и для включения эффекта 
нажимаем педаль портаменто. Последовательность байт показана на рис. 40.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/240.gif" alt="Рис. 40" width="520" height="388" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Громкость и экспрессия
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Прежде, чем говорить про управление громкостью в MIDI, стоит вспомнить о
 том, как обстоит дело при работе с "живыми" музыкантами.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Все существующие исполнительские составы можно разделить на два типа: <i>естественно сбалансированные</i> и <i>несбалансированные</i>.
 К первому типу относятся составы, которые могут звучать без системы 
звукоусиления (без "подзвучки" микрофонами), в естественных акустических
 условиях. По большей части это оркестры и камерные ансамбли, 
исполняющие классическую музыку, иногда джазовые оркестры и небольшие 
коллективы. Во времена, когда писалась классическая музыка, 
звукоинженеров не было, и о балансе заботились сообща: архитекторы при 
строительстве концертных залов, мастера при изготовлении музыкальных 
инструментов, композиторы, дирижеры и, конечно, сами музыканты.
</p>

<p>
Управляя оркестром, дирижер создает комфортное, сбалансированное 
звучание, следуя партитуре композитора. Композитор, в свою очередь, при 
создании партитуры следит за тем, чтобы ни один из компонентов ансамбля 
или оркестра не заглушал другой. Так, например, одна скрипка обладает 
очень тихим звуком по сравнению с тромбоном. Если нужно сбалансировать 
эти инструменты, композитор поручает одну и ту же партию нескольким 
скрипкам, то есть группе музыкантов. При этом происходит естественное 
акустическое звукоусиление более тихих инструментов по сравнению с более
 громкими.
</p>

<p>
Большая же часть современной музыки исполняется несбалансированными 
составами, то есть составами, которые не могут прозвучать в естественной
 акустике без системы звукоусиления и искусственной регулировки баланса.
 Надеюсь, не стоит объяснять, что если в рок-группе музыкант играет соло
 на флейте, то без подзвучки оно безнадежно утонет в мощном звуке 
остальных инструментов. Балансировку такого состава производит 
звукоинженер электронным способом, в микшерном пульте, при этом исходная
 акустическая мощность сигналов значения не имеет. Легким движением 
фейдера ту же флейту можно сделать в два раза громче всех остальных 
инструментов, поскольку звук к слушателю приходит от акустических систем
 концертного зала. И хотя музыканты по ходу исполнения могут изменять 
динамику звука, решающее слово в балансе остается за звукоинженером. Это
 тем более относится к чисто электронной музыке, где живые исполнители 
вовсе отсутствуют.
</p>

<p>
Так что же с MIDI?
</p>

<p>
Предположим, стоит задача сымитировать звучание естественно 
сбалансированного состава. В этом случае, по идее, достаточно одного 
параметра Velocity: скорость нажатия клавиш определяет текущий 
динамический оттенок (форте или пиано) партии. Однако при совместном 
звучании партий в мультитембральном тон-генераторе их относительный 
баланс чаще всего неудовлетворителен и требует дополнительной 
регулировки.
</p>

<p>
Связано это с тем, что при создании пэтчей не учитывается реальная 
акустическая мощность инструментов. Ранее говорилось о рекомендованном 
соотношении значения динамики (Velocity) и выходного уровня сигнала. Так
 вот, для всех пэтчей оно одно и то же. Это значит, что при игре с одной
 и той же динамикой, например, партии клавесина и трубы, выходной 
уровень обоих партий будет примерно одинаковым, чего в реальной жизни 
быть не может (труба намного громче клавесина). В принципе, такого 
несоответствия можно избежать, уменьшая выходной уровень семплов в 
настройках акустически тихих программ, но это не выход. Во-первых, при 
прочих равных условиях ухудшится соотношение сигнал/шум, а во-вторых, 
при имитации несбалансированного ансамбля такая поправка в уровне будет 
только мешать.
</p>

<p>
Итак, параметра Velocity для выстраивания баланса нескольких партий 
недостаточно. На помощь приходит сообщение MIDI Volume (контроллер 
СС#7/СС#39), которое задает громкость звучания на MIDI-канале. Его 
действие можно сравнить с фейдером канала в микшерском пульте. С какой 
бы динамикой не извлекал звуки исполнитель, уровень партии в миксе будет
 зависеть от положения фейдера. Говоря языком MIDI — какая бы скорость 
нажатия не использовалась, выходная громкость партии будет зависеть от 
значения MIDI Volume.
</p>

<p>
В современных тон-генераторах тембр при увеличении динамики, как 
правило, изменяется (становится ярче). Применяя совместно Velocity и 
MIDI Volume, можно получить любые сочетания "яркость/громкость". 
Например, максимальное значение Velocity при небольшой громкости канала 
создает впечатление очень яркого по тембру, но тихого инструмента.
</p>

<p>
В мультитембральном тон-генераторе после отстройки относительного 
баланса партий (с помощью сообщения MIDI Volume) может потребоваться 
регулировка общей громкости устройства (уровня мастер-выхода). Для этого
 чаще всего используется сообщение SysEx Master Volume (поговорим в 
следующей статье), иногда — значение громкости одного из каналов или 
контроллера типа General Purpose.
</p>

<p>
Большинство устройств игнорируют LSB в сообщении MIDI Volume и позволяют
 производить только грубую настройку (128 уровней), посредством MSB 
(контроллер CC#7). Некоторые старые синтезаторы на сообщение MIDI Volume
 не реагируют.
</p>

<p>
Бок о бок с сообщением громкости канала идет сообщение экспрессии 
(Expression, СС#11 / CC#43). Его название может сбить с толку, поскольку
 прямой перевод с английского (expression — выразительность) — довольно 
расплывчатое понятие. Многие в этой связи склонны ожидать от контроллера
 экспрессии какую-либо тонкую настройку пэтча (например, посредством 
фильтров) или других чудес. На самом деле все гораздо проще.
</p>

<p>
Слово Expression как музыкальный термин соответствует понятию "нюанс" 
русской музыкальной терминологии, которое означает, прежде всего, 
динамический нюанс исполнения — форте, пиано и т. д. Таким образом, 
контроллер экспрессии предназначен для дополнительного управления 
громкостью MIDI-канала. Как и в случае с сообщением MIDI Volume, 
большинство тон-генераторов допускают только грубую настройку экспрессии
 (128 уровней) посредством MSB (контроллер CC#11).
</p>

<p>
При максимальном значении экспрессии громкость канала равна текущему 
значению MIDI Volume. При уменьшении экспрессии начинается уменьшение 
результирующей громкости. Когда экспрессия равна нулю, громкость канала 
также равна нулю; когда экспрессии "половина", то и громкость канала 
равна половине от текущего значения MIDI Volume.
</p>

<p>
Зачем нужно такое двухуровневое управление громкостью? Для удобства. 
Довольно часто требуется плавное нарастание или затухание звука 
(крещендо или диминуэндо) в каком-либо месте партии. Предположим, что 
для этой цели у нас есть только контроллер MIDI Volume. С помощью него 
мы создаем кривую нарастания звука, которая имеет довольно затейливую 
форму. В соло нарастание звучит хорошо. Но в миксе партия теряется. Как 
быть? "Поднять" всю кривую. Это значит, что каждое событие об изменении 
громкости канала должно быть пересчитано в сторону увеличения, а это не 
всегда делается легко и быстро. Кроме того, может просто не хватить 
запаса по громкости: если некоторые события MIDI Volume на кривой уже 
имеют большое значение, например, 120, то поднять всю кривую более чем 
на 7 пунктов не получится. А партия все равно может звучать недостаточно
 громко...
</p>

<p>
Гораздо проще управлять динамикой внутри партии с помощью сообщения 
экспрессии, а с помощью MIDI Volume балансировать партию со всеми 
остальными. Тогда в нашем случае задача упрощается: нужно только 
увеличить общую громкость канала, а кривая нарастания останется 
неизменной.
</p>

<p>
Исходя из этого, протокол MIDI рекомендует использовать сообщение MIDI 
Volume только для общей балансировки партий, один раз в самом начале 
аранжировки, а динамические изменения в процессе звучания производить с 
помощью сообщения экспрессии.
</p>

<p>
Еще один пример. Предположим, мы отстроили баланс партий рояля и баса 
так, что партия рояля имеет громкость 110, а баса — 90. Теперь, если в 
какой-то момент времени понадобится, скажем, уменьшить громкость обеих 
партий в два раза, достаточно послать на оба канала сообщение экспрессии
 со значением 64. После этого громкость рояля станет равна 55, а баса — 
45. Можно представлять себе контроллер громкости как фейдер канала в 
микшере — с помощью него производится статическая балансировка. 
Экспрессия в данном случае является аналогом группового фейдера, с 
помощью которого изменяется громкость нескольких дорожек, с сохранением 
относительного баланса между ними.
</p>

<p>
Сообщение MIDI Volume обычно производится слайдером громкости на 
передней панели инструмента, для сообщения экспрессии может 
использоваться педаль. Однако записывать в секвенсор лучше только 
сообщения экспрессии, поскольку сообщение MIDI Volume должно появляться 
на канале один раз в самом начале аранжировки. Если инструмент 
позволяет, лучше настроить его так, чтобы вместо СС#7 передавалось 
сообщение экспрессии. А можно использовать возможность переназначения 
контроллеров в секвенсоре. После записи всех партий сообщения громкости 
канала вводятся вручную, в процессе отстройки баланса.
</p>

<p>
Теперь пример. Мы работаем на десятом MIDI-канале и выставляем уровень 
громкости на 100 (чаще всего это значение используется по умолчанию), а 
экспрессию на 120. Наш тон-генератор понимает только грубую настройку 
посредством MSB. Последовательность байт изображена на рис. 41.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/241.gif" alt="Рис. 41" width="480" height="264" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Протокол MIDI рекомендует логарифмическую зависимость уровня сигнала на 
выходе MIDI-канала от значений громкости и экспрессии. Если 
тон-генератор на экспрессию не реагирует, она считается максимальной, и 
формула приобретает вид, показанный на рис. 42_1а для случая, когда 
используется грубая настройка посредством MSB (CC#7), и на рис. 42_1б, 
если используется тонкая настройка (MSB:LSB, CC#7/CC#39). Если 
устройство реагирует на экспрессию, то значения громкости и экспрессии 
перемножаются: рис. 42_2а при грубой настройке обоих параметров, рис. 
42_2б — при тонкой.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/242.gif" alt="Рис. 42" width="427" height="660">
</p>

<p>
Трехмерный график на рис. 43 наглядно иллюстрирует эту зависимость. Под 
графиком приводится таблица с несколькими значениями контроллеров и 
выходным уровнем канала.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/243.gif" alt="Рис. 43" width="427" height="514">
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Панорама
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Сообщение Pan (контроллеры CC#10/CC#42) устанавливает панораму на 
MIDI-канале, то есть определяет положение партии в стереобазе. Сообщение
 имеет смысл только для тех тон-генераторов, которые имеют стереовыход 
или несколько выходов, работающих как стереопары.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
В зависимости от конкретной архитектуры тон-генератора это сообщение 
может быть регулятором панорамы или баланса. Например, если структура 
пэтча такова, что в блок VCA инструмента приходит моносигнал, то под 
воздействием сообщения Pan синтезатор просто делит моносигнал на левый и
 правый канал в нужной пропорции, и с выхода блока снимается 
псевдостереосигнал. Но во многих тон-генераторах используются 
стереосемплы (или задействованы два осциллятора, или несколько слоев с 
установленным положением слоя в стереобазе на уровне пэтча). Так как в 
этом случае сигнал приходит на вход VCA уже стереофоническим, то 
сообщение будет работать как регулятор баланса, то есть задавать 
относительный уровень левого и правого каналов.
</p>

<p>
Панорама должна влиять на все ноты канала, включая уже звучащие в момент
 прихода сообщения (хотя не все тон-генераторы следуют этому 
требованию). Реакция устройства на изменение панорамы должна быть 
немедленной. Некоторые устройства не позволяют выполнять динамическое 
панорамирование — как только на канале появилось сообщение Pan, оно 
считается фиксированным и все последующие сообщения игнорируются.
</p>

<p>
Большинство устройств реагируют только на MSB сообщения (контроллер 
CC#10) и, таким образом, позволяют разбить всю стереобазу на 128 точек. 
При этом за центральное положение считается значение 64, значения, 
меньшие 64 (до 0) — панорама влево, большие (до 127) — вправо. Для тех 
устройств, которые используют тонкую подстройку для панорамы, 
центральным значением является 8182 (шестнадцатеричное 0x2000). 
Увеличение значения (до 16383) — панорама вправо, уменьшение (до 0) — 
влево.
</p>

<p>
Если мы работаем на первом MIDI-канале и панорамируем партию в положение
 "полулево", то получится последовательность байт, показанная на рис. 
44.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/244.gif" alt="Рис. 44" width="427" height="185">
</p>

<p>
Рекомендованная формула для уровня левого и правого каналов при заданном значении панорамы изображена на рис. 45.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/245.gif" alt="Рис. 45" width="427" height="239">
</p>

<p>
Графики на рис. 46 наглядно демонстрируют эту зависимость: левый — в децибелах, правый — в процентах от максимальной амплитуды.
</p>

<br>
 </font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/246.gif" alt="Рис. 46" width="606" height="284" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
<font face="Arial, sans serif">
<big>
<b>
Педали
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
В спецификации определены сообщения для семи различных типов педалей. 
При этом только одно из них (Foot Controller) попадает в разряд 
непрерывных контролеров высокого разрешения. Все остальные являются 
контроллерами-переключателями.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Сообщение <b>Foot Controller</b> (CC#4/CC#36) может управлять всем, чем 
угодно. Многие устройства позволяют музыканту настроить любой параметр 
для изменения посредством этого сообщения. Поскольку физически педаль 
выполняется на основе потенциометра (то есть может выдавать некоторый 
диапазон значений), то часто она применяется для тех же эффектов, что и 
послекасание. Иногда — для изменения строя партии в реальном времени.
</p>

<p>
Педали-переключатели делятся на две группы: педали, аналогичные педалям 
рояля (Damper, Sustenuto, Soft), и специальные педали, предназначенные 
для звукоизвлечения, не характерного для клавишного инструмента 
(Portamento, Legato, Hold 2). Действие педали портаменто обсуждалось 
ранее.
</p>

<p>
Сообщение <b>Damper Pedal</b> (оно же Sustain Pedal, оно же Hold Pedal),
 СС#64, действует аналогично правой педали фортепиано (когда демпферы 
поднимаются со всех струн и остаются в таком состоянии до отпускания 
педали). Ноты, звучащие в момент прихода сообщения, а также все 
последующие продолжают звучать на участке поддержки (Sustain) до тех 
пор, пока педаль не будет отпущена. При этом неважно, отпустили вы 
нажатые клавиши или нет. Если вы отпустили все клавиши, но держите 
педаль нажатой, ноты могут звучать неограниченно долго. После отпускания
 педали все ноты на канале разом затухают (переходят в стадию Release). 
Если при нажатой педали пришло сообщение режима канала All Notes Off, то
 его выполнение задерживается до отпускания педали.
</p>

<p>
Сообщение педали сустейна является настоящим пожирателем полифонии. Ведь
 пока нота не выключена, голос (или несколько голосов), необходимые для 
ее воспроизведения, заняты и не могут быть отданы под вновь поступившие 
ноты. Превысить доступную полифонию не составляет труда — достаточно при
 нажатой педали взять по очереди десяток-другой нот.
</p>

<p>
Замечу, что это сообщение не позволяет осуществить полноценную имитацию 
действия правой педали фортепиано, поскольку имеет только два жестких 
состояния: On и Off. В реальной жизни правую педаль можно нажать не до 
конца, а чуть-чуть, чтобы демпферы оставались очень близко к струнам и в
 какой-то мере влияли на их звучание.
</p>

<p>
Пример последовательности байт при нажатии педали на втором MIDI-канале показан на рис. 47.
</p>

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/247.gif" alt="Рис. 47" width="427" height="187">
</p>

<p>
Сообщение <b>Sustenuto</b> (СС#66) действует аналогично средней педали 
(sostenuto) у рояля (эта педаль еще называется селективной педалью 
сустейна). При поступлении сообщения выдерживаются только ноты, которые в
 этот момент уже звучат. Ноты, взятые при нажатой педали, ведут себя 
обычным образом. Так же, как и в предыдущем случае, если при нажатой 
педали пришло сообщение режима канала All Notes Off, то его выполнение 
задерживается до отпускания педали.
</p>

<p>
Опытные пианисты широко используют эту педаль, поскольку она позволяет 
придать исполнению тонкую нюансировку и избежать общего педального гула.
 Например, берется аккорд, затем нажимается педаль состенуто, затем 
аккорд снимается. Но он продолжает звучать, создавая общую гармонию, на 
фоне которой последующие ноты звучат с демпферами, а, значит, без гула, 
образуя интересные сочетания с фоновым аккордом.
</p>

<p>
Сообщение <b>Soft Pedal </b>(CC#67) действует аналогично левой педали 
фортепиано — при ее нажатии звук приглушается. У пианино и роялей 
реализация механизма приглушения разная, но в любом случае звук 
становится не только тише, но еще и приобретает более мягкую окраску. 
Обычно тон-генераторы реагируют на это сообщение простым уменьшением 
громкости, но в некоторых пэтчах (имитирующих звуки рояля) может 
меняться и окраска.
</p>

<p>
Сообщение <b>Legato Footswitch </b>(CC#68, появилось в 1992 году) 
включает эффект легато, то есть связной игры двух последовательных нот. 
Эффект достигается тем, что у второй ноты пропускается стадия атаки в 
огибающей. Педаль легато часто используется для имитации фраз духового 
или струнного инструмента, но также популярна и с синтетическими 
звуками.
</p>

<p>
Сообщение <b>Hold 2 </b>(оно же Sustain 2), СС#69, имеет смысл только 
для тех инструментов, генератор огибающей которых имеет две стадии 
поддержки. При нажатии педали включается вторая стадия.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Синтез
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
В каждом синтезаторе применяется своя схема синтеза, своя конструкция 
компонентов (осцилляторов, фильтров, усилителей и т. д.), свои варианты 
их использования. Причем в продукции одной и той же фирмы эти варианты 
часто отличаются. Поэтому спецификация определяет только самые общие, 
наиболее характерные для большинства тон-генераторов параметры. 
Например, управление длительностью фаз в генераторе огибающей. Если 
предложенные сообщения производителя не удовлетворяют, он всегда может 
использовать SysEx или NRPN.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Сообщение <b>Balance</b> (CC#8/CC#40) изначально предполагалось 
использовать в тех тон-генераторах, у которых в структуре каждого голоса
 есть два осциллятора. Такая структура позволяет создавать битембральные
 звуки (например, один осциллятор производит прямоугольную волну, другой
 — "пилу" или шум), а также использовать стереосемплы (один осциллятор 
воспроизводит левый канал, другой правый). Сообщение Balance изменяет 
относительный уровень первого и второго осциллятора. Среднее значение 
говорит о том, что сигнал с обоих осцилляторов берется в равной 
пропорции, значения меньше среднего — преобладает первый осциллятор, 
больше — второй. Баланс осцилляторов регулируется перед панорамированием
 канала посредством сообщения Pan. Это позволяет сначала задать исходную
 стереокартину пэтча, а потом спанорамировать пэтч в миксе. Здесь 
прослеживается некоторая аналогия с контроллерами экспрессии и 
громкости.
</p>

<p>
Однако это сообщение, скорее, рудимент, оно редко используется 
производителями. В современных тон-генераторах усложнилась структура 
синтеза, пэтчи стали многослойными, с собственными настройками каждого 
слоя и прочими тонкостями, которыми проще управлять с помощью SysEx или 
NRPN. Короче, сообщение Balance не прижилось. Правда, некоторые 
производители (например, Korg) иногда используют его совместно с 
инсертными эффектами для управления балансом после обработки. Причем, 
как правило, в виде грубой настройки (CC#8).
</p>

<p>
Остальные сообщения, влияющие на синтез, являются непрерывными 
контроллерами низкого разрешения. Стандартное значение для них — 64.
</p>

<p>
Сообщение <b>Sound Controller 1</b> (CC#70, оно же Sound Variation) 
может влиять на любой блок в структуре синтеза (огибающие, фильтры, цепи
 модуляции и т. п.). Например, если используется принцип воспроизведения
 семплов, это сообщение может управлять скоростью проигрывания семпла 
(что, соответственно, изменяет высоту тона). В FM-синтезаторе оно может 
задавать глубину частотной модуляции и тому подобное.
</p>

<p>
Сообщение <b>Sound Controller 2</b> (CC#71, оно же Timbre/Harmonic Intensity) управляет фильтром (VCF). Как правило, этот параметр задает глубину резонанса.
</p>

<p>
Сообщение <b>Sound Controller 3</b> (CC#72, оно же Release Time) управляет временем затухания генератора огибающей (VCA), сообщение<b> Sound Controller 4</b> (CC#73, оно же Attack Time) — временем атаки.
</p>

<p>
Сообщение <b>Sound Controller 5</b> (CC#74, оно же Brightness) управляет частотой среза фильтра.
</p>

<p>
Работа пяти следующих сообщений (<b>Sound Controller 6, 7, 8, 9, 10</b>)
 изначально не регламентировалась, кроме того, что это были 
дополнительные контроллеры для изменения параметров синтеза. Но с 
появлением спецификации General MIDI 2 их действие четко определено. 
Поговорим об этом в статье, посвященной совместимости.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Эффекты
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Спецификация MIDI создавалась в тот момент, когда встроенные эффекты в 
синтезаторах были немногочисленны, имели немного параметров настройки, 
либо вовсе отсутствовали. Поэтому стандартных сообщений для управления 
эффектами всего семь. Естественно, они не дают той полноты управления, 
каковую предлагают для встроенных эффектов современные тон-генераторы. 
Так что многие производители в дополнение к стандартным сообщениям 
широко используют сообщения SysEx или NRPN.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Первые два сообщения, <b>Effect Control 1</b> (CC#12/CC#44) и <b>Effect Control 2</b>
 (CC#13/CC#45), — непрерывного типа и высокого разрешения. Стандартная 
реакция на них протоколом не определена, тон-генератор может 
использовать их для любого параметра, имеющего отношение к встроенному 
эффекту.
</p>

<p>
Следующие пять сообщений относятся к контроллерам низкого разрешения. 
Если байт данных в них равен нулю, то инструмент должен отключить 
эффект.
</p>

<p>
Сообщение <b>Effect 1 Depth </b>(CC#91, оно же Reverb Send Level) 
изначально называлось просто External Effect Depth (глубина внешнего 
эффекта). Часто применяется для управления количеством реверберации (или
 уровнем посыла на ревербератор).
</p>

<p>
Сообщение <b>Effect 2 Depth </b>(CC#92, оно же Tremolo Depth) задает глубину амплитудной модуляции (глубину тремоло).
</p>

<p>
Сообщение <b>Effect 3 Depth </b>(CC#93, оно же Chorus Send Level, изначально называлось Chorus Depth) задает глубину (уровень) хоруса.
</p>

<p>
Сообщение <b>Effect 4 Depth </b>(CC#94, оно же Celeste (Detune) Depth) задает глубину расстройки, что актуально для такого инструмента, как челеста.
</p>

<p>
Сообщение <b>Effect 5 Depth </b>(CC#95, оно же Phaser Depth) задает глубину (уровень) обработки эффектом фейзер.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
Контроллеры общего назначения
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Четыре сообщения <b>General Purpose Controller</b> (1, 2, 3, 4) из блока
 непрерывных контроллеров высокого разрешения, как следует из названия, 
могут управлять любой функцией устройства. Часто эти сообщения 
генерируются слайдерами, фейдерами и прочими ползунками, поэтому 
некоторые их называют General Purpose Slider.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
Аналогичные им четыре сообщения <b>General Purpose Controller</b> (5, 6, 7, 8) находятся в блоке непрерывных контроллеров низкого разрешения.
</p>

<p>
<font face="Arial, sans serif">
<big>
<b>
RPN
</b>
</big>
<br>

<font face="Verdana, Tahoma, Arial, sans serif">
Параметр <b>Pitch Bend Sensitivity</b> (имеет номер 0) задает 
чувствительность звуковысотного колеса. А если точнее — диапазон 
изменения высоты тона от центрального значения. В MSB передаются 
полутона, в LSB — в центы. Например, для настройки диапазона в +/-3 
полутона и 8 центов (на первом MIDI-канале) последовательность байт 
показана на рис. 48. Если центы не важны, посылать LSB не нужно.
</font></font></p><font face="Arial, sans serif"><font face="Verdana, Tahoma, Arial, sans serif">

<p>
<img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/248.gif" alt="Рис. 48" width="427" height="376">
</p>

<p>
Параметр <b>Channel Fine Tuning </b>(номер 1)<b> </b>раньше назывался 
просто Fine Tuning. С помощью него можно подстроить высоту тона для 
звучащей на канале программы в центах. Значение 8192 (0x2000) означает 
стандартную настройку (то есть нота Ля первой октавы имеет частоту 440 
Гц). Значение 0 — строй понижается на 100 центов, 16383 (0x7F7F) — 
повышается на 100 центов.
</p>

<p>
Типичный пример. Мы работаем на седьмом MIDI-канале и хотим понизить 
строй партии на 15 центов. Рассчитаем, какое значение должно быть у RPN 
номер 1. Стандартной настройке соответствует значение 8192, понижению на
 100 центов — 0. Стало быть, для понижения партии на 15 центов нужно 
8192 умножить на 15/100. Получится 1228,8. Дробную часть мы передать не 
можем, поэтому округляем до 1229. Преобразуем это число в MSB и LSB: MSB
 = 1229 / 128 = 9, LSB = 1229 - (9 x 128) = 77. Последовательность байт 
показана на рис. 49.
</p>

<br>
 </font></font></font></font></font></font></font></font></font></font></font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/249.gif" alt="Рис. 49" width="480" height="393" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Теперь, если понадобится изменить настройку на 1, можно воспользоваться 
контроллером Data Increment, а не посылать MSB и LSB заново (рис. 50). 
Контроллер Data Increment/Decrement работает по отношению к тому RPN, 
который последний подвергался настройке (если последним был NRPN, то по 
отношению к нему).
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="ffffff" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/250.gif" alt="Рис. 50" width="606" height="204" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Параметр <b>Channel Coarse Tuning </b>(номер 2)<b> </b>раньше назывался 
Coarse Tuning. С помощью него строй партии можно менять шагами по 100 
центов (т. е. в полутонах). Используется только MSB: значение 64 (0x40) 
означает стандартную настройку, значение 0 — строй понижается на 6400 
центов (64 полутона), 127 (0x7F) — повышается на 6300 центов (63 
полутона).
</p>

<p>
Параметры с номерами 3 и 4 (<b>Tuning Program Change</b> и <b>Tuning Bank Select</b>
 соответственно) используются в устройствах, которые отвечают 
спецификации MIDI Tuning (рассмотрим ее в отдельной статье). Так же, как
 и тембры, строи организуются в программы и банки. RPN 3 и 4 работают по
 аналогии с сообщениями Program Change и Bank Select, то есть позволяют 
выбрать для канала конкретный строй.
</p>

<p>
Наконец, предусмотрен служебный параметр <b>RPN Reset</b> (номер 16383).
 Представьте такую ситуацию: вы выбрали RPN номер 1 для тонкой 
подстройки партии. После чего установили какое-либо значение в центах 
(путем использования контроллеров Data Entry или Data 
Increment/Decrement) и спокойно продолжаете работать. Тон-генератор все 
это время считает текущим RPN номер 1, и будет так считать до тех пор, 
пока явно не задать новый RPN контроллерами RPN MSB и RPN LSB.
</p>

<p>
Если в то время, пока активен RPN номер 1, случайно будет изменен 
контроллер Data Entry или Data Increment/Decrement, то у вас собьется 
настройка партии! Для страховки от подобных случайностей и придуман 
параметр RPN Reset. После его применения контролеры Data Entry и Data 
Increment/Decrement как бы отключаются от последнего активного RPN. 
Обычно рекомендуется всегда посылать RPN Reset после завершения 
настройки какого-либо RPN. На всякий случай.
</p>

<p>
Пример использования RPN Reset на первом MIDI-канале при понижении стандартной настройки на полутон показан на рис. 51.
</p>

<br>
 </font></td>
 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td colspan="3" bgcolor="555581" align="RIGHT">
  <img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/251.gif" alt="Рис. 51" width="480" height="432" align="middle">
 </td>

 <td width="25">
  &nbsp;
 </td>
</tr>
<tr>
 <td width="129" bgcolor="555581">
  &nbsp;
 </td>
 <td width="50">
  &nbsp;
 </td>
 <td width="427">
  <br>

<font size="2" face="Verdana, Tahoma, Arial, sans serif">

<p>
Ну что ж, все сообщения канала мы рассмотрели. В следующей статье 
поговорим о системных сообщениях, работе приемных и передающих устройств
 и методах оптимизации при передаче сообщений.
</p>

<p>
<table width="427" cellspacing="0" cellpadding="1" bgcolor="555581">
<tbody><tr>
<td>
<font size="2" face="Arial, sans serif" color="ffffff">
<b>
&nbsp;
Оценка статьи
</b></font></td></tr></tbody></table>

<font size="2" face="Arial, sans serif">
</font></p><form method="post"><font size="2" face="Arial, sans serif"><font size="2" face="Arial" color="#000000">Посещений: 16485 | Проголосовавших: 
26 | Средняя оценка: 5.0<p><input type="hidden" name="envoi" value="1">&nbsp;<select name="note"><option value="5" selected="selected">5</option><option value="4">4</option><option value="3">3</option><option value="2">2</option><option value="1">1</option></select>&nbsp;&nbsp;<input type="submit" value="Оценить"></p></font>

<p></p>

<p>
<table width="427" cellspacing="0" cellpadding="1" bgcolor="555581">
<tbody><tr>
<td>
<font size="2" face="Arial, sans serif" color="ffffff">
<b>
&nbsp;
Комментарии
</b></font></td></tr></tbody></table>

<font size="1" face="Arial, sans serif">
<noindex><!--217.107.142.33--></noindex></font></p><div align="RIGHT"><font size="1" face="Arial, sans serif"><small>05.12.05 03:35</small>
        </font></div><font size="1" face="Arial, sans serif">
	<b></b> <a href="mailto:"></a><br>Очень интересная, и главное, поучительная статья!<br><hr>
<!--195.248.172.107--><div align="RIGHT"><small>07.12.05 13:09</small>
        </div>
	<b>mus</b> <a href="mailto:"></a><br>Обалденная статья! По больше бы таких.<br><hr>
<!--217.15.145.135--><div align="RIGHT"><small>07.12.05 22:08</small>
        </div>
	<b>Макс</b> <a href="mailto:"></a><br>Супер<br><hr>
<!--82.207.13.46--><div align="RIGHT"><small>26.07.06 02:47</small>
        </div>
	<b>юра</b> <a href="mailto:juricd@yandex.ru">juricd@yandex.ru</a><br>Кроме
 теории нужны практические схемы на относительно доступных
(для СНГ)деталях.В частности невозможно найти схему контроллера "колёс" 
"pitch band" и "vibrato" с использованием валкодера и вообще схему этого
 узла,который очень нужен для динамичной музыки.И нужны ссылки на 
путёвые сайты,потому что от поисковиков 0!!! результатов.На этом 
всё.Пока<br><hr>


<big><b>В связи с обилием спама размещение комментариев отключено. Пользуйтесь <a href="http://www.muzoborudovanie.ru/forum/index.php?site=mo&amp;bn=">форумами</a>.</b><br></big>
<br>


<table width="427" cellspacing="1" cellpadding="1" border="0" bgcolor="000000">

<tbody><tr bgcolor="d0d0d0">
<td align="CENTER">
<font size="0">
<a href="http://www.muzoborudovanie.ru/ads/adrates.php">РЕКЛАМА</a>
</font>

</td></tr><tr bgcolor="ffeecc">
<td align="CENTER">

<!-- Yandex.RTB R-A-2736-1 -->
<div id="yandex_rtb_R-A-2736-1"><yatag class="ef965c5e3 j685cd6f9" id="ef965c5e3" lang="ru"><yatag class="xf1102df6 k22d07b8c h1c63f14a ef969ed76"><yatag class="e5154e7c6 jdfd809d3 w99d17d7d wd09387c0" style="min-height: 150px !important; min-width: 423px !important; max-width: 423px !important;"><yatag data-id="212663125119248880" class="x8d85563f j2e302cb5 t5f0de921" style="width: 421px !important; margin: auto !important;"><yatag class="b273c2866" style="min-height: 148px !important; font-size: 12.8923px !important;"><yatag class="m74e54116"><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="jc8f2e1f7" target="_blank"><yatag class="hd60535f p66ad1374 x112aa72"><yatag class="x3fd5d464">Яндекс.Директ</yatag></yatag></a><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="hd60535f i86531a78" style="min-width: 148px !important; max-width: 168.4px !important;" target="_blank"><yatag class="d4f43c659"><yatag class="te2d32b95"><yatag style="position: absolute !important; width: 234.333% !important; padding-top: 88.0952% !important; transform: translate(-28.6629%) scale(1) !important; transform-origin: 50% 50% 0px !important;" class=""><img alt="" style="position: absolute !important; left: 0px !important; top: 0px !important; width: 100% !important; height: 100% !important;" class="gfdd5eb9b" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/huge.webp"></yatag></yatag></yatag></a><yatag class="x9efba79d"><yatag class="q23dffcbf j5940ffe2"><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="hd60535f a931a30e0" target="_blank"><yatag class="x3fd5d464 y4623338a">Синтезатор Roland E-A7</yatag></a></yatag><yatag class="n3ed47cf"><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="hd60535f t317acc90" target="_blank"><yatag class="x3fd5d464 y4623338a">Купить за&nbsp;82&nbsp;990&nbsp;<span class="v9e555d00">руб</span>.</yatag></a></yatag><yatag class="s10dea69 j27ae2f8b"><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="hd60535f i83cce865 hbed6fc1a" target="_blank"><yatag class="hf30ea3ed"><yatag class="ef32c9c79"><yatag class="x3fd5d464">Узнать больше</yatag></yatag></yatag></a><yatag class="b5192ec9e d65171841"><yatag class="hf30ea3ed"><yatag class="ef32c9c79"><a href="https://an.yandex.ru/count/8aObAejS0GC507u2CGSCCbq00000EE0gG0980c2y26W4SAg3fw87W07kWvsVvkEMnTe1Y06W-X2G0U2dzTY9_yFp1Q01Xj_nvooe0OY4hQCgi066oQq2k06O-83E6C010jW1ZeAd4-01Witv0kW1SlW1ehVUlW680W6O0eAfm0sW0lBwjm-v0fs24hDiontjm0AW-X3m0kZmiQ8E-0A2W820WB1AW0EsavJM1eW3oP3gPAW31B031BW4_m7e1ByU-0J5rm-81SNN3v05zfege0Myv0Ie1RB-0x05ilu3k0NGtGh01Vk26SW5gAu6q0MtyW7W1Jxe1G7m1G6O1eBGhFCEe0Qg0wW6gWEf1-M8f3QSxD4ui0U0W90qm0U6x8iQq0SGs0S4u0U62lW70O080T08cegGYS2GW8A80U08kVtR1u0A0PWAeeanmGe00000003mFzWA0k0AW8bw-0g0jHY82mAg2n01Si0MvOW007wE2UWCZWK0m0k0emN82u3Kam7P2-M8f3QSxD4uw0l5rm_m2mg83AAtthu1w0m1c0tlmKlW3GA93W0000000F0_a0x0X3sW3i24FR0E0Q4F00000000y3-e3-MHahB0a_leEDaFTleJm5Rz-Z_W3m6049Ikkn2G4Ew-ciBhiCVTCPeG2H400000003mFyWGeAe2q13VXgzV-10HW14HY143a141eH400000003mFwWHm8Gzi141o163zeKDw17Dd-YLtjNadcNn4G000000JAf0-X4P3G00000L000001q000009G00000j000008WI0P0I0QaIHxEHvw4P5J_m4X7u4W604nc84m6G4pAO4m40?stat-id=1&amp;test-tag=327105132943361&amp;format-type=54&amp;actual-format=40&amp;banner-test-tags=eyIyMTI2NjMxMjUxMTkyNDg4ODAiOiIzMjcxMDQ3MDkyOTYxMjgifQ%3D%3D&amp;" class="hd60535f e2fb68a61" target="_blank"><yatag class="x3fd5d464">love-piano.ru</yatag></a></yatag></yatag></yatag></yatag></yatag></yatag></yatag><yatag class="p6068e37b i479b6b96"><yatag class="d145c8e2c"><yatag class="r8b8fb24d"><yatag></yatag></yatag></yatag></yatag><yatag class="l26d8ea30 mcf44d63 u17b0f0fb"><yatag class="w5b2f4875"><yatag class="g8d2ebee5 sebf41d7d d117994ed"><yatag class="v9323f0c2"><yatag style="width: 8px !important; height: 8px !important;" class="s29e09ca2"><svg width="8px" height="8px" viewBox="0 0 14 14"><polygon points="8.28616426 7.02081528 13.6638974 12.3985484 12.3985484 13.6638974 7.02081528 8.28616426 1.64308213 13.6638974 0.377733152 12.3985484 5.7554663 7.02081528 0.377733152 1.64308213 1.64308213 0.377733152 7.02081528 5.7554663 12.3985484 0.377733152 13.6638974 1.64308213"></polygon></svg></yatag><yatag class="u8082070"><yatag class="g3ea35b64"></yatag><yatag class="e48ab0060">Скрыть&nbsp;объявление</yatag></yatag></yatag></yatag></yatag></yatag></yatag></yatag><yatag id="p69deabf2"><yatag class="jba863d44"></yatag></yatag></yatag></yatag></div>
<script type="text/javascript">
    (function(w, d, n, s, t) {
        w[n] = w[n] || [];
        w[n].push(function() {
            Ya.Context.AdvManager.render({
                blockId: "R-A-2736-1",
                renderTo: "yandex_rtb_R-A-2736-1",
                async: true
            });
        });
        t = d.getElementsByTagName("script")[0];
        s = d.createElement("script");
        s.type = "text/javascript";
        s.src = "//an.yandex.ru/system/context.js";
        s.async = true;
        t.parentNode.insertBefore(s, t);
    })(this, this.document, "yandexContextAsyncCallbacks");
</script>

</td></tr></tbody></table>
<br>
</font></font></form></font></td>

<td width="25">
&nbsp;
</td>
</tr>

<tr>
<td width="129" bgcolor="555581">
<font size="0">
&nbsp;
</font></td>
<td width="50">
<font size="0">
&nbsp;
</font></td>
<td width="427" bgcolor="555581">
<font size="0">
&nbsp;
</font></td>
<td width="25">
<font size="0">
&nbsp;
</font></td>
</tr>

</tbody></table>

</td><td width="129" valign="TOP" bgcolor="555581" align="CENTER"> 

<script type="text/javascript"><!--
google_ad_client = "pub-0269592369109973";
//120x600
google_ad_slot = "8729918506";
google_ad_width = 120;
google_ad_height = 600;
//--></script>
<script type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/show_ads.js">
</script><ins id="aswift_1_expand" style="display:inline-table;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px;background-color:transparent;" data-ad-slot="8729918506"><ins id="aswift_1_anchor" style="display:block;border:none;height:600px;margin:0;padding:0;position:relative;visibility:visible;width:120px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_1" name="aswift_1" style="left:0;position:absolute;top:0;border:0px;width:120px;height:600px;" width="120" height="600" frameborder="0"></iframe></ins></ins>

<br>
<br>

<table width="111" cellspacing="0" cellpadding="2" border="0">
<tbody><tr bgcolor="dedede">
<td align="CENTER">
<font size="0">
<a href="http://www.muzoborudovanie.ru/ads/adrates.php">
Цены на рекламу
</a>
</font></td>
</tr>
</tbody></table>

</td>
</tr>
</tbody></table>






 


<script type="text/javascript">
<!--
var _acic={dataProvider:10};(function(){var e=document.createElement("script");e.type="text/javascript";e.async=true;e.src="//www.acint.net/aci.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)})()
//-->
</script>
<table width="760" cellspacing="0" cellpadding="0" border="0" bgcolor="dedede">
<tbody><tr valign="TOP" align="CENTER">
<td width="129">

<noindex>
<br>
<!-- SpyLOG -->
<script src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/counter_cv.js" id="spylog_code" type="text/javascript" counter="10716" part="" track_links="ext" page_level="1">
</script><a href="https://spylog.com/cnt?cid=10716&amp;p=1&amp;f=3"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/cnt.gif" id="spylog_img" alt="SpyLOG" width="88" height="31" border="0"></a>
<noscript>
<a href="http://u107.16.spylog.com/cnt?cid=10716&f=3&p=1" target="_blank">
<img src="http://u107.16.spylog.com/cnt?cid=10716&p=1" alt="SpyLOG" border="0" width="88" height="31"></a>
</noscript>
<!--/ SpyLOG -->

<!--Rating@Mail.ru COUNTEr--><script language="JavaScript" type="text/javascript"><!--
d=document;var a='';a+=';r='+escape(d.referrer)
js=10//--></script><script language="JavaScript1.1" type="text/javascript"><!--
a+=';j='+navigator.javaEnabled()
js=11//--></script><script language="JavaScript1.2" type="text/javascript"><!--
s=screen;a+=';s='+s.width+'*'+s.height
a+=';d='+(s.colorDepth?s.colorDepth:s.pixelDepth)
js=12//--></script><script language="JavaScript1.3" type="text/javascript"><!--
js=13//--></script><script language="JavaScript" type="text/javascript"><!--
d.write('<a href="http://top.mail.ru/jump?from=120209"'+
' target=_top><img src="http://d5.cd.b1.a0.top.list.ru/counter'+
'?id=120209;t=49;js='+js+a+';rand='+Math.random()+
'" alt="Рейтинг@Mail.ru"'+' border=0 height=31 width=88/><\/a>')
if(11<js)d.write('<'+'!-- ')//--></script><a href="http://top.mail.ru/jump?from=120209" target="_top"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/counter.gif" alt="Рейтинг@Mail.ru" width="88/" height="31" border="0"></a><!-- <noscript><a
target=_top href="http://top.mail.ru/jump?from=120209"><img
src="http://d5.cd.b1.a0.top.list.ru/counter?js=na;id=120209;t=49"
border=0 height=31 width=88
alt="Рейтинг@Mail.ru"/></a></noscript><script language="JavaScript" type="text/javascript"><!--
if(11<js)d.write('--'+'>')//--><!--/COUNTER-->

</noindex>

</td>

<td width="502">
<p>
<font size="-2" face="Verdana, Tahoma, Arial, sans serif">
</font></p><p><font size="-2" face="Verdana, Tahoma, Arial, sans serif">
<br>
Музыкальное Оборудование
<br><a href="http://www.muzoborudovanie.ru/">www.muzoborudovanie.ru</a>
<br>www.moline.ru
<br><a href="mailto:mail@muzoborudovanie.ru">mail@muzoborudovanie.ru</a>
<br><a href="http://www.muzoborudovanie.ru/data.php">© Агентство ДАТА</a>
<br>
</font></p></td>

<td width="129">
<p>
<noindex>
<br>
<!-- begin of Top100 code -->
<script id="top100Counter" type="text/javascript" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/top100.jcn"></script><a href="https://top100.rambler.ru/home?id=196166" target="_blank"><img src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/a.gif" title="Rambler's Top100" alt="Rambler's Top100" border="0"></a><noscript><a href="http://top100.rambler.ru/home?id=196166" target="_blank"><img src="http://cnt.rambler.ru/top100.cnt?196166" alt="Rambler's Top100" width="81" height="63" border="0" /></a></noscript>
<!-- end of Top100 code -->
</noindex>

</p></td>
</tr>
</tbody></table>

</center>
</font><iframe src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/a.htm" style="width:1px;height:1px;display:none;" width="0" height="0" frameborder="0"></iframe><iframe id="google_osd_static_frame_7093369334545" name="google_osd_static_frame" style="display: none; width: 0px; height: 0px;"></iframe><ins class="adsbygoogle adsbygoogle-noablate" style="display: none !important;" data-adsbygoogle-status="done"><ins id="aswift_2_expand" style="display:inline-table;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><ins id="aswift_2_anchor" style="display:block;border:none;height:0px;margin:0;padding:0;position:relative;visibility:visible;width:0px;background-color:transparent;"><iframe marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" scrolling="no" allowfullscreen="true" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){try{h=s.upd(h,i)}catch(e){}w.location.replace(h)}}" id="aswift_2" name="aswift_2" style="left:0;position:absolute;top:0;border:0px;width:0px;height:0px;" frameborder="0"></iframe></ins></ins></ins></body><iframe id="google_esf" name="google_esf" src="MIDI%20%D0%B2%20%D0%B4%D0%B5%D1%82%D0%B0%D0%BB%D1%8F%D1%85.%20%D0%A7%D0%B0%D1%81%D1%82%D1%8C%202%20%E2%80%94%20%D0%A1%D0%BE%D0%BE%D0%B1%D1%89%D0%B5%D0%BD%D0%B8%D1%8F%20%D0%BA%D0%B0%D0%BD%D0%B0%D0%BB%D0%B0.%20-%20%D0%9C%D0%9E_files/zrt_lookup.htm" style="display: none;" data-ad-client="ca-pub-0269592369109973"></iframe></html>